<!-- GFM-TOC -->
* [?õ•????](#?õ•????)
    * [1. InnoDB](#1-innodb)
    * [2. MyISAM](#2-myisam)
    * [3. InnoDB ?? MyISAM ????](#3-innodb-??-myisam-????)
* [????????](#????????)
    * [1. ????](#1-????)
    * [2. ??????](#2-??????)
    * [3. ?????](#3-?????)
    * [4. ????????](#4-????????)
* [????](#????)
    * [1. ????????](#1-????????)
        * [1.1 B-Tree ????](#11-b-tree-????)
        * [1.2 ???????](#12-???????)
        * [1.3. ????????????R-Tree??](#13-????????????r-tree??)
        * [1.4 ???????](#14-???????)
    * [2. ?????????](#2-?????????)
    * [3. ???????](#3-???????)
        * [3.1 ????????](#31-????????)
        * [3.2 ??????](#32-??????)
        * [3.3 ????????](#33-????????)
        * [3.4 ?????ß÷????](#34-?????ß÷????)
        * [3.5 ???????](#35-???????)
        * [3.6 ????????](#36-????????)
    * [4. B-Tree ?? B+Tree ???](#4-b-tree-??-b+tree-???)
        * [4. 1 B-Tree](#4-1-b-tree)
        * [4.2 B+Tree](#42-b+tree)
        * [4.3 ?????????????? B+Tree](#43-??????????????-b+tree)
        * [4.4 ?????? B-Tree ?? B+Tree](#44-??????-b-tree-??-b+tree)
* [??????????](#??????????)
    * [1. Explain](#1-explain)
    * [2. ??????????](#2-??????????)
    * [3. ??????????](#3-??????????)
    * [4. ????? DELETE ?? INSERT ???](#4-?????-delete-??-insert-???)
* [??????????ß’????](#??????????ß’????)
    * [1. ???????](#1-???????)
    * [2. ??ß’????](#2-??ß’????)
* [???????](#???????)
* [?????????????](#?????????????)
    * [1. ???????](#1-???????)
    * [2. ??????](#2-??????)
* [?¶œ?????](#?¶œ?????)
<!-- GFM-TOC -->

# ?õ•????

## 1. InnoDB

InnoDB ?? MySQL ??????????????ó®???????? InnoDB ??????????????????????????õ•???µµ

???? MVCC ?????????????????????????????????????????????????

?????????????????????????????????????ß‹?????????

????????????????????????????????????????????????????????ß’??? hash ??????????????????????????????????????????????????????????

????ßª???????????????????????

## 2. MyISAM

MyISAM ??????????????????????????????????Åâ????GIS??????? MyISAM ???????????ßﬁ?????????????????????????

????????????????????????ß≥?

????????????????ßﬁ??????????????????????????????????????????????ßª????????????????????????????

???????????????????ß≥?

???????? DELAY_KEY_WRITE ??????????????????????????????????????????ß’???????????ß’??????ß÷??????????????????????????????????????????????????ß’????????????????????????ß’?????????????????????????????????????????????????????????

??????????????????????????????????????????????????????? MyISAM ?????

???????????????????ß≥?????????????????????????????????? MyISAM??

MyISAM ?????????????????õ•?????????ßª???????????®¢?

## 3. InnoDB ?? MyISAM ????

**????**

InnoDB ??????????

**????**

InnoDB ?????????????

**???????**

MyISAM ??????????????? InnoDB ??????????????????????

**????**

MyISAM ??????????? InnoDB ??????ßﬁ?????

**????????**

MyISAM ????????????????????????

# ????????

## 1. ????

TINYINT, SMALLINT, MEDIUMINT, INT, BIGINT ?????? 8, 16, 24, 64 ¶À?õ•????????????ß≥??????®¢?

INT(11) ?ß÷????????’«??????????????????????????õ•???????????????????

## 2. ??????

FLOAT ?? DOUBLE ??????????DECIMAL ??????ß≥???????CPU ????????????????????? DECIMAl ??????????? DECIMAL ?????????????????????????

FLOAT??DOUBLE ?? DECIMAL ??????????ß·????? DECIMAL(18, 9) ?????? 18 ¶À??? 9 ¶À?õ•ß≥?????????? 9 ¶À?õ•?????????

## 3. ?????

????? CHAR ?? VARCHAR ?????????????????????????????

VARCHAR ??????????????????????????õ•??????????????????? UPDATE ????????ß“??????????????????????????????ß≥????????ßÿ?????????MyISAM ???ß”????????¶ƒõ•???? InnoDB ??????????????ßŸ??????

VARCHAR ??????????¶¬????? CHAR ???????

## 4. ????????

MySQL ?????????????????????????DATATIME ?? TIMESTAMP??

**DATATIME**

???????? 1001 ?? 9999 ????????????????????? 8 ????õ•???

???????????

?????????MySQL ???????????????????????? DATATIME ??????≥è2008-01016 22:37:08???????? ANSI ????????????????????????

**TIMESTAMP**

?? UNIX ?????????????? 1970 ?? 1 ?? 1 ????????????????????????????????? 4 ????????????? 1970 ?? ?? 2038 ??

????????ß€??

MySQL ???? FROM_UNIXTIME() ?????? Unxi ??????????????????? UNIX_TIMESTAMP() ?????????????? Unix ??????

??????????????????????? TIMESTAMP ?ß÷?????????????????????

????????? TIMESTAMP????????? DATETIME ???ßπ??????

# ????

????????õ•?????????????????????????????????????õ•??????ß”?????????????????

???????????????????????????????????

??????ß≥???????????????????????????????ßπ???????ß÷?????????????????ßπ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????°¬?????????

## 1. ????????

### 1.1 B-Tree ????

B-Tree ?????????? MySQL ?õ•?????????????????

???????????????????—k?????????????????????????????????

????????????????????ßµ?????????ß€????????B-Tree ?????????????????????¶∂?????????????ßﬁ?????????????????????????

?????????????????????????????Óï

???????????????ß÷??????ß”??????????????????

### 1.2 ???????

????????????????????????

?? MySQL ????? Memory ??????????????????

InnoDB ?????????????????ß≥????????????????????????????????????????????? B-Tree ???????????????????????????????? B-Tree ???????ß€?????????ßª??????????????????

?????????????????????????????????õ•?????????????????????ß÷???????????ß≥???????????????ß÷??ß÷???????????????????????????????????????????????????????????????????????????????¶∂??????????????????????????®≤?????

### 1.3. ????????????R-Tree??

MyISAM ?õ•??????????????????????????????õ•??

??????????????????????????????????ßπ?????????????????????????

### 1.4 ???????

MyISAM ?õ•???????????????????????????ß÷??????????????????????ß÷????

??? MATCH AGAINST????????????? WHERE??

## 2. ?????????

- ????????????????????????????

- ??????????????????????????????

- ????? I/O ?????? I/O??

## 3. ???????

### 3.1 ????????

????ß”??????????ß”?????????????????????????????????????????????????

?????????????????? actor_id ?ß÷???????

```sql
SELECT actor_id FROM sakila.actor WHERE actor_id + 1 = 5;
```

### 3.2 ??????

???? BLOB??TEXT ?? VARCHAR ??????ßµ??????????????????????????????????

???????????????????? **?????????** ?????????????????????????????????????????????ßπ???????????? 1 ???????????????¶∑???????????????

### 3.3 ????????

??????????????????????ß”????????????????????????????????????®¢??????????????ßµ????? actor_id ?? file_id ???????????????

```sql
SELECT file_id, actor_ id FROM sakila.film_actor
WhERE actor_id = 1 OR film_id = 1;
```

### 3.4 ?????ß÷????

?????????????????ßŸ?????ó®????????????????? customer_id ???????? staff_id ???????????? customer_id ?ßŸ??????????????µµ

```sql
SELECT COUNT(DISTINCT staff_id)/COUNT(*) AS staff_id_selectivity,
COUNT(DISTINCT customer_id)/COUNT(*) AS customer_id_selectivity,
COUNT(*)
FROM payment;
```

```html
   staff_id_selectivity: 0.0001
customer_id_selectivity: 0.0373
               COUNT(*): 16049
```

### 3.5 ???????

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/b9e9ae8c-e216-4c01-b267-a50dbeb98fa4.jpg)

????????????????????????????????????õ•?????

????????????????ß‹?????????????õ•?????InnoDB ???????????????ß’???? B-Tree ???????ß≥?

?????????????ß’???????????????????????????????????????????

**???**

1. ??????????????????????? I/O ??????
2. ???????????? B-Tree ?ßµ??????????????

**???**

1. ?????????????????? I/O ??????????????????????????????????ó®????????????????
2. ???????????????????????????????????????????
3. ????????????????????????????ßÿ???????????¶À?®¢?
4. ?????????????????ßµ??õ•????????????????????????????ßµ????????°¿?????????????
5. ????ß“????—k????????????????????õ•?????????????????????????????????????

### 3.6 ????????

??????????????????????¶≈????

## 4. B-Tree ?? B+Tree ???

### 4. 1 B-Tree

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/5ed71283-a070-4b21-85ae-f2cbfd6ba6e1.jpg)

??????? B-Tree??????????????????????????? [key, data]??key ?????????data ????????? key ????????

B-Tree ???????????????????????

- ?????????????????????????? B-Tree ???????
- ???????ß÷? key ????????????ßµ?
- ?????????????????? key ????? key<sub>i</sub> ?? key<sub>i+1</sub>?????? null?????????????????? key ???? key<sub>i</sub> ??ß≥?? key<sub>i+1</sub>??

?? B-Tree ?ß—? key ?????????????????????????????ßÿ?????????????????????? data????????????????????????????ß”????????????????? null ????????????????????????

???????????????????????? B-Tree ????????????????????????????????????????????????????????? B-Tree ?????

### 4.2 B+Tree

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/63cd5b50-d6d8-4df6-8912-ef4a1dd5ba13.jpg)

?? B-Tree ????B+Tree ??????????

- ??????????????? 2d ?????? 2d+1??
- ?????õ• data????õ• key????????õ•???

### 4.3 ?????????????? B+Tree

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/1ee5f0a5-b8df-43b9-95ab-c516c54ec797.jpg)

????????????????????????? B+Tree ????????? B+Tree ????????????????????????????????????????????????????????????????????????

### 4.4 ?????? B-Tree ?? B+Tree

?????????????????????????????????????????????????????? B-/+Tree ???????????

???????????õ•????????ÔÖ?????????????????????????õ•?????????????ß≥????ÔÖ????õ•???????????????????ßµ?????ß≥???? 4k??????????????????¶À?????????

?????????????????????????????õ•??????ßµ???????????????????????????õ•????????????????? I/O?????????????????????????????¶∆?????????????????????????????????????????????????????????????????¿ˆ?????????????????????®¢????????????????????????????????????????????ß≥?????????????????????????????? I/O ????????????B-Tree ????¶Ã????????? h-1 ?? I/O??????????ó•???????????? O(h)=O(logdN)????????????ßµ????? d ??????????????????? 100????? h ???ß≥??????????? 3??????????????????h ????????????????????????????????????????????????????????ßπ??????? B-Tree ????

B+Tree ????????????????????????? d ?ß€?????? B+Tree ????????? data ??????????ß⁄??????????ß⁄?????????

# ??????????

## 1. Explain

???????? SQL ???????????ß“???????????ßµ?

- select_type : ?????????ßﬁ?????????????????

- key : ????????

- rows : ????????

## 2. ??????????

???????????????????????????????????????????????????????ß≥?

??®∞????? SELECT * ???????????????????ß≥?

## 3. ??????????

?????? LIMIT ???????????????ßª?ß≥?

????????????????????????????????“¬????????????????????????????????????????????—k???????????????›î?ßﬁ?????????? Explain ???????????? rows ????????????????

```sql
SELECT * FROM sakila.film_actor WHERE film_id = 1;
```

## 4. ????? DELETE ?? INSERT ???

??????????ß÷???????????????????????????????????????????????????????ß≥????????????

```sql
DELEFT FROM messages WHERE create < DATE_SUB(NOW(), INTERVAL 3 MONTH);
```
```sql
rows_affected = 0
do {
    rows_affected = do_query(
    "DELETE FROM messages WHERE create  < DATE_SUB(NOW(), INTERVAL 3 MONTH) LIMIT 10000")
} while rows_affected > 0
```

# ??????????ß’????

## 1. ???????

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/f0cae5ac-6891-44c2-9d4c-9c10260a7321.jpg)

????ùp????????binlog ????I/O ???? SQL ????

1. **binlog ???**????????????????????????ß’????????????binlog???ß≥?
2. **I/O ???**???????????????????????????????????ß’???ßﬁ?????ß≥?
3. **SQL ???**?????????ßﬁ????????????ß÷? SQL ???

## 2. ??ß’????

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/e0451f3c-fcb8-42ca-8eda-47c06effdb1e.jpg)

????????????????ß’??????????????????????????????

??ß’???????????????????????????????®∞??????ß’?????????????????????????????? Amoeba ???????????

MySQL ??ß’??????????????????????

1. ????????????????????ß’??????????????????????
2. ??????????????? MyISAM ???ó®?????????????????????????
3. ?????????????????

# ???????

**1. ????????????**

????????????????ß≥????ßªß≥????ß”???????????????????????????????????ÔÖ??ßª???????õ•??????????????????õ•???????????????????°¿????????????

**2. ??°¬??????????**

??????????????????????ß÷???????????????ß÷?????????????????????ß’????????????????????

**3. ????ßŸ?**

??????????Óî??????ß‘?????????????????????????Ì‡??????????????? payDB?????????? userDB ???????????õ•?????????ß€??????????ß€???

**4. ???ßŸ?**

????ß÷??????????????õ•??????????????ßµ????∫ñ id ??????????????ß›????

**5. ????ßŸ??????ßŸ?????**

?????????ß÷???????????????????????????????????ßŸ????????

??????????????????????????????????????ßŸ??

**6. ???ßŸ???????**

????????? merge ?õ•???µµ

**7. ???????????????**

(1) ????????

????ßŸ???????????????õ•??????????????????????????????????????????????????????????????????????????????????????????????®Æ????ßø????????¶√???????????????????????????????

(2) ?????????????

?????????????????????????????????????????????????????????????????????????????????????????????????¶À?????????????????????????????????????????¶¬????????????????????ßÿ?¶¬?????®¿?

# ?????????????

?????????????ß›???????????????????ß›???????????????????????????????????????ß›?????????????????????????

## 1. ???????

**1.1 ??????????ß›????**

??????????????????????????-????????ß÷?????????????????

**1.2 ???? IP ????? IP ?ß€?**

? MySQL ???????????? IP ??????? MySQL ????ßπ???????? IP ??????????? MySQL ?????????

**1.3 ?ßﬁ?????????**

???????????°§????????????????????????

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/fabd5fa0-b75e-48d0-9e2c-31471945ceb9.jpg)

**1.4 ??????ß’?????????**

??????????????????ß·???????????????????

## 2. ??????



# ?¶œ?????

- ???????? MySQL??

- [MySQL ????????????????????? ](http://blog.codinglabs.org/articles/theory-of-mysql-index.html)

- [MySQL ????????master-slave???? ??ß’????MySQL-Proxy??](http://blog.tanpeng.net/2017/08/22/master-slave/)

- [MySQL ??ß’?????????? ](https://segmentfault.com/a/1190000003716617)

- [Mysql ?????????????????????????? ](http://www.cnblogs.com/langtianya/p/4997768.html)

- [MySQL ???????????? ](http://www.runoob.com/w3cnote/mysql-index.html)

- [20+ ?? MySQL ??????????????? ](https://www.jfox.info/20-tiao-mysql-xing-nen-you-hua-de-zui-jia-jing-yan.html)

- [ ?????????????????????????????õ•???? MySQL????????? ...](https://www.nowcoder.com/questionTerminal/bd526c55f8c74e99a86f48d5f5c5bb93)
