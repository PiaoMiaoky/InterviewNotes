<!-- GFM-TOC -->
* [å¼•å­](#å¼•å­)
* [ç¬¬ 1 ç«  è®¾è®¡æ¨¡å¼å…¥é—¨](#ç¬¬-1-ç« -è®¾è®¡æ¨¡å¼å…¥é—¨)
* [ç¬¬ 2 ç«  è§‚å¯Ÿè€…æ¨¡å¼](#ç¬¬-2-ç« -è§‚å¯Ÿè€…æ¨¡å¼)
* [ç¬¬ 3 ç«  è£…é¥°æ¨¡å¼](#ç¬¬-3-ç« -è£…é¥°æ¨¡å¼)
* [ç¬¬ 4 ç«  å·¥å‚æ¨¡å¼](#ç¬¬-4-ç« -å·¥å‚æ¨¡å¼)
    * [4.1 ç®€å•å·¥å‚](#41-ç®€å•å·¥å‚)
    * [4.2 å·¥å‚æ–¹æ³•æ¨¡å¼](#42-å·¥å‚æ–¹æ³•æ¨¡å¼)
    * [4.3 æŠ½è±¡å·¥å‚æ¨¡å¼](#43-æŠ½è±¡å·¥å‚æ¨¡å¼)
* [ç¬¬ 5 ç«  å•ä»¶æ¨¡å¼](#ç¬¬-5-ç« -å•ä»¶æ¨¡å¼)
* [ç¬¬ 6 ç«  å‘½ä»¤æ¨¡å¼](#ç¬¬-6-ç« -å‘½ä»¤æ¨¡å¼)
* [ç¬¬ 7 ç«  é€‚é…å™¨æ¨¡å¼ä¸å¤–è§‚æ¨¡å¼](#ç¬¬-7-ç« -é€‚é…å™¨æ¨¡å¼ä¸å¤–è§‚æ¨¡å¼)
    * [7.1 é€‚é…å™¨æ¨¡å¼](#71-é€‚é…å™¨æ¨¡å¼)
    * [7.2 å¤–è§‚æ¨¡å¼](#72-å¤–è§‚æ¨¡å¼)
* [ç¬¬ 8 ç«  æ¨¡æ¿æ–¹æ³•æ¨¡å¼](#ç¬¬-8-ç« -æ¨¡æ¿æ–¹æ³•æ¨¡å¼)
* [ç¬¬ 9 ç«  è¿­ä»£å™¨å’Œç»„åˆæ¨¡å¼](#ç¬¬-9-ç« -è¿­ä»£å™¨å’Œç»„åˆæ¨¡å¼)
    * [9.1 è¿­ä»£å™¨æ¨¡å¼](#91-è¿­ä»£å™¨æ¨¡å¼)
    * [9.2 Java å†…ç½®çš„è¿­ä»£å™¨](#92-java-å†…ç½®çš„è¿­ä»£å™¨)
    * [9.3 ç»„åˆæ¨¡å¼](#93-ç»„åˆæ¨¡å¼)
* [ç¬¬ 10 ç«  çŠ¶æ€æ¨¡å¼](#ç¬¬-10-ç« -çŠ¶æ€æ¨¡å¼)
* [ç¬¬ 11 ç«  ä»£ç†æ¨¡å¼ // TODO](#ç¬¬-11-ç« -ä»£ç†æ¨¡å¼--todo)
* [ç¬¬ 12 ç«  å¤åˆæ¨¡å¼](#ç¬¬-12-ç« -å¤åˆæ¨¡å¼)
    * [12.1 MVC](#121-mvc)
        * [12.1.1 ä¼ ç»Ÿ MVC](#1211-ä¼ ç»Ÿ-mvc)
        * [12.1.2 Web ä¸­çš„ MVC](#1212-web-ä¸­çš„-mvc)
* [ç¬¬ 13 ç«  ä¸è®¾è®¡æ¨¡å¼ç›¸å¤„](#ç¬¬-13-ç« -ä¸è®¾è®¡æ¨¡å¼ç›¸å¤„)
* [ç¬¬ 14 ç«  å‰©ä¸‹çš„æ¨¡å¼ // TODO](#ç¬¬-14-ç« -å‰©ä¸‹çš„æ¨¡å¼--todo)
<!-- GFM-TOC -->

# å¼•å­

- å­¦ä¹ å›¾ç‰‡å¼å’Œäº¤è°ˆå¼çš„èµ„æ–™æ•ˆç‡ä¼šæ›´é«˜ã€‚

- åªæœ‰åœ¨è‡ªå·±è®¤ä¸ºä¸€æ ·ä¸œè¥¿å¾ˆé‡è¦æ—¶ï¼Œæ‰ä¼šå»è®¤çœŸå¯¹å¾…å®ƒã€‚å°±åƒé‡åˆ°è€è™ï¼Œé‚£ä¹ˆå¤§è„‘ä¼šç«‹é©¬å‘ç”ŸåŒ–å­¦ååº”ï¼Œè°ƒåŠ¨ä¸€åˆ‡ç¥ç»åšå‡ºååº”ï¼Œå› ä¸ºå¤§è„‘è§‰å¾—ç”Ÿå­˜ç‰¹åˆ«é‡è¦ã€‚

- é‡‡ç”¨é‡å¤æ‰‹æ³•ï¼Œè¿ç”¨å¤šç§å½¢å¼ï¼Œè®©ä¸€ä¸ªå†…å®¹åœ¨å¤§è„‘çš„å¤šä¸ªåŒºéƒ½æœ‰å®¹èº«ä¹‹åœ°ã€‚

- é€šè¿‡å½±å“æƒ…ç»ªï¼Œè®©å¤§è„‘æŠ•å…¥æ›´å¤§çš„æ³¨æ„åŠ›ã€‚

- é‡‡ç”¨æ‹Ÿäººçš„æ‰‹æ³•ï¼Œå› ä¸ºäººè¿˜æ˜¯æ¯”è¾ƒå–œæ¬¢å’Œäººæ‰“äº¤é“ã€‚

- å¦‚æœçœ‹ä¹¦æ•ˆç‡ä½ä¸‹ï¼Œæµ®å…‰æ å½±åœ°åœ¨ç¿»ä¹¦ï¼Œå°±è¦åœä¸‹æ¥ä¼‘æ¯ä¸€ä¸‹ã€‚

# ç¬¬ 1 ç«  è®¾è®¡æ¨¡å¼å…¥é—¨

**1. è®¾è®¡æ¨¡å¼æ¦‚å¿µ**

è®¾è®¡æ¨¡å¼ä¸æ˜¯ä»£ç ï¼Œè€Œæ˜¯è§£å†³é—®é¢˜çš„æ–¹æ¡ˆï¼Œå­¦ä¹ ç°æœ‰çš„è®¾è®¡æ¨¡å¼å¯ä»¥åšåˆ°ç»éªŒå¤ç”¨ã€‚

æ‹¥æœ‰è®¾è®¡æ¨¡å¼è¯æ±‡ï¼Œåœ¨æ²Ÿé€šæ—¶å°±èƒ½ç”¨æ›´å°‘çš„è¯æ±‡æ¥è®¨è®ºï¼Œå¹¶ä¸”ä¸éœ€è¦äº†è§£åº•å±‚ç»†èŠ‚ã€‚

**2. é—®é¢˜æè¿°**

è®¾è®¡ä¸åŒç§ç±»çš„é¸­å­æ‹¥æœ‰ä¸åŒçš„å«å£°å’Œé£è¡Œæ–¹å¼ã€‚

**3. ç®€å•å®ç°æ–¹æ¡ˆ**

ä½¿ç”¨ç»§æ‰¿çš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼Œè¿™ç§æ–¹æ¡ˆä»£ç æ— æ³•å¤ç”¨ï¼Œå¦‚æœä¸¤ä¸ªé¸­å­ç±»æ‹¥æœ‰åŒæ ·çš„é£è¡Œæ–¹å¼ï¼Œå°±æœ‰ä¸¤ä»½é‡å¤çš„ä»£ç ã€‚

![](https://github.com/00000H/notes/blob/master/pics/144d28a0-1dc5-4aba-8961-ced5bc88428a.jpg)

**4. è®¾è®¡åŸåˆ™**

**å°è£…å˜åŒ–**åœ¨è¿™é‡Œå˜åŒ–çš„æ˜¯é¸­å­å«å’Œé£è¡Œçš„è¡Œä¸ºæ–¹å¼ã€‚

**é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œè€Œä¸æ˜¯é’ˆå¯¹å®ç°ç¼–ç¨‹** å˜é‡å£°æ˜çš„ç±»å‹ä¸ºçˆ¶ç±»ï¼Œè€Œä¸æ˜¯å…·ä½“çš„æŸä¸ªå­ç±»ã€‚çˆ¶ç±»ä¸­çš„æ–¹æ³•å®ç°ä¸åœ¨çˆ¶ç±»ï¼Œè€Œæ˜¯åœ¨å„ä¸ªå­ç±»ã€‚ç¨‹åºåœ¨è¿è¡Œæ—¶å¯ä»¥åŠ¨æ€æ”¹å˜å˜é‡æ‰€æŒ‡å‘çš„å­ç±»ç±»å‹ã€‚

è¿ç”¨è¿™ä¸€åŸåˆ™ï¼Œå°†å«å’Œé£è¡Œçš„è¡Œä¸ºæŠ½è±¡å‡ºæ¥ï¼Œå®ç°å¤šç§ä¸åŒçš„å«å’Œé£è¡Œçš„å­ç±»ï¼Œè®©å­ç±»å»å®ç°å…·ä½“çš„å«å’Œé£è¡Œæ–¹å¼ã€‚

![](https://github.com/00000H/notes/blob/master/pics/1c8ccf5c-7ecd-4b8a-b160-3f72a510ce26.png)

**å¤šç”¨ç»„åˆï¼Œå°‘ç”¨ç»§æ‰¿** ç»„åˆä¹Ÿå°±æ˜¯ has-a å…³ç³»ï¼Œé€šè¿‡ç»„åˆï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€æ”¹å˜å®ç°ï¼Œåªè¦é€šè¿‡æ”¹å˜çˆ¶ç±»å¯¹è±¡å…·ä½“æŒ‡å‘å“ªä¸ªå­ç±»å³å¯ã€‚è€Œç»§æ‰¿å°±ä¸èƒ½åšåˆ°è¿™äº›ï¼Œç»§æ‰¿ä½“ç³»åœ¨åˆ›å»ºç±»æ—¶å°±å·²ç»ç¡®å®šã€‚

è¿ç”¨è¿™ä¸€åŸåˆ™ï¼Œåœ¨ Duck ç±»ä¸­ç»„åˆ FlyBehavior å’Œ QuackBehavior ç±»ï¼ŒperformQuack() å’Œ performFly() æ–¹æ³•å§”æ‰˜ç»™è¿™ä¸¤ä¸ªç±»å»å¤„ç†ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¸€ä¸ª Duck å­ç±»å¯ä»¥æ ¹æ®éœ€è¦å»å®ä¾‹åŒ– FlyBehavior å’Œ QuackBehavior çš„å­ç±»å¯¹è±¡ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥åŠ¨æ€åœ°è¿›è¡Œæ”¹å˜ã€‚

![](https://github.com/00000H/notes/blob/master/pics/29574e6f-295c-444e-83c7-b162e8a73a83.jpg)

**5. æ•´ä½“è®¾è®¡å›¾**

![](https://github.com/00000H/notes/blob/master/pics/e13833c8-e215-462e-855c-1d362bb8d4a0.jpg)

**6. æ¨¡å¼å®šä¹‰**

**ç­–ç•¥æ¨¡å¼** ï¼šå®šä¹‰äº†ç®—æ³•æ—ï¼Œåˆ†åˆ«å°è£…èµ·æ¥ï¼Œè®©å®ƒä»¬ä¹‹é—´å¯ä»¥äº’ç›¸æ›¿æ¢ï¼Œæ­¤æ¨¡å¼è®©ç®—æ³•çš„å˜åŒ–ç‹¬ç«‹äºä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ã€‚

**7. å®ç°ä»£ç **

```java
public abstract class Duck {
    FlyBehavior flyBehavior;
    QuackBehavior quackBehavior;

    public Duck(){
    }

    public void performFly(){
        flyBehavior.fly();
    }

    public void setFlyBehavior(FlyBehavior fb){
        flyBehavior = fb;
    }

    public void performQuack(){
        quackBehavior.quack();
    }

    public void setQuackBehavior(QuackBehavior qb){
        quackBehavior = qb;
    }
}
```
```java
public class MallarDuck extends Duck{
    public MallarDuck(){
        flyBehavior = new FlyWithWings();
        quackBehavior = new Quack();
    }
}
```
```java
public interface FlyBehavior {
    void fly();
}
```
```java
public class FlyNoWay implements FlyBehavior{
    @Override
    public void fly() {
        System.out.println("FlyBehavior.FlyNoWay");
    }
}
```
```java
public class FlyWithWings implements FlyBehavior{
    @Override
    public void fly() {
        System.out.println("FlyBehavior.FlyWithWings");
    }
}
```
```java
public interface QuackBehavior {
    void quack();
}
```
```java
public class Quack implements QuackBehavior{
    @Override
    public void quack() {
        System.out.println("QuackBehavior.Quack");
    }
}
```
```java
public class MuteQuack implements QuackBehavior{
    @Override
    public void quack() {
        System.out.println("QuackBehavior.MuteQuack");
    }
}
```
```java
public class Squeak implements QuackBehavior{
    @Override
    public void quack() {
        System.out.println("QuackBehavior.Squeak");
    }
}
```
```java
public class MiniDuckSimulator {
    public static void main(String[] args) {
        Duck mallarDuck = new MallarDuck();
        mallarDuck.performQuack();
        mallarDuck.performFly();
        mallarDuck.setFlyBehavior(new FlyNoWay());
        mallarDuck.performFly();
    }
}
```
æ‰§è¡Œç»“æœ
```html
QuackBehavior.Quack
FlyBehavior.FlyWithWings
FlyBehavior.FlyNoWay
```

# ç¬¬ 2 ç«  è§‚å¯Ÿè€…æ¨¡å¼

**1. æ¨¡å¼å®šä¹‰**

å®šä¹‰äº†å¯¹è±¡ä¹‹é—´çš„ä¸€å¯¹å¤šä¾èµ–ï¼Œå½“ä¸€ä¸ªå¯¹è±¡æ”¹å˜çŠ¶æ€æ—¶ï¼Œå®ƒçš„æ‰€æœ‰ä¾èµ–è€…éƒ½ä¼šå—åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°ã€‚ä¸»é¢˜ï¼ˆSubjectï¼‰æ˜¯è¢«è§‚å¯Ÿçš„å¯¹è±¡ï¼Œè€Œå…¶æ‰€æœ‰ä¾èµ–è€…ï¼ˆObserverï¼‰æˆä¸ºè§‚å¯Ÿè€…ã€‚

![](https://github.com/00000H/notes/blob/master/pics/26cb5e7e-6fa3-44ad-854e-fe24d1a5278c.jpg)

**2. æ¨¡å¼ç±»å›¾**

ä¸»é¢˜ä¸­å…·æœ‰æ³¨å†Œå’Œç§»é™¤è§‚å¯Ÿè€…ï¼Œå¹¶é€šçŸ¥æ‰€æœ‰æ³¨å†Œè€…çš„åŠŸèƒ½ï¼Œä¸»é¢˜æ˜¯é€šè¿‡ç»´æŠ¤ä¸€å¼ è§‚å¯Ÿè€…åˆ—è¡¨æ¥å®ç°è¿™äº›æ“ä½œçš„ã€‚

è§‚å¯Ÿè€…æ‹¥æœ‰ä¸€ä¸ªä¸»é¢˜å¯¹è±¡çš„å¼•ç”¨ï¼Œå› ä¸ºæ³¨å†Œã€ç§»é™¤è¿˜æœ‰æ•°æ®éƒ½åœ¨ä¸»é¢˜å½“ä¸­ï¼Œå¿…é¡»é€šè¿‡æ“ä½œä¸»é¢˜æ‰èƒ½å®Œæˆç›¸åº”åŠŸèƒ½ã€‚

![](https://github.com/00000H/notes/blob/master/pics/5c558190-fccd-4b5e-98ed-1896653fc97f.jpg)

**3. é—®é¢˜æè¿°**

å¤©æ°”æ•°æ®å¸ƒå‘Šæ¿ä¼šåœ¨å¤©æ°”ä¿¡æ¯å‘ç”Ÿæ”¹å˜æ—¶æ›´æ–°å…¶å†…å®¹ï¼Œå¸ƒå‘Šæ¿æœ‰å¤šä¸ªï¼Œå¹¶ä¸”åœ¨å°†æ¥ä¼šç»§ç»­å¢åŠ ã€‚

**4. è§£å†³æ–¹æ¡ˆç±»å›¾**

![](https://github.com/00000H/notes/blob/master/pics/760a5d63-d96d-4dd9-bf9a-c3d126b2f401.jpg)

**5. è®¾è®¡åŸåˆ™**

**ä¸ºäº¤äº’å¯¹è±¡ä¹‹é—´çš„æ¾è€¦åˆè®¾è®¡è€ŒåŠªåŠ›** å½“ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´æ¾è€¦åˆï¼Œå®ƒä»¬ä¾ç„¶å¯ä»¥äº¤äº’ï¼Œä½†æ˜¯ä¸å¤ªæ¸…æ¥šå½¼æ­¤çš„ç»†èŠ‚ã€‚ç”±äºæ¾è€¦åˆçš„ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´äº’ç›¸ä¾èµ–ç¨‹åº¦å¾ˆä½ï¼Œå› æ­¤ç³»ç»Ÿå…·æœ‰å¼¹æ€§ï¼Œèƒ½å¤Ÿåº”å¯¹å˜åŒ–ã€‚

**6. å®ç°ä»£ç **

```java
public interface Subject {
    public void resisterObserver(Observer o);
    public void removeObserver(Observer o);
    public void notifyObserver();
}
```
```java
import java.util.ArrayList;
import java.util.List;

public class WeatherData implements Subject {
    private List<Observer> observers;
    private float temperature;
    private float humidity;
    private float pressure;

    public WeatherData() {
        observers = new ArrayList<>();
    }

    @Override
    public void resisterObserver(Observer o) {
        observers.add(o);
    }

    @Override
    public void removeObserver(Observer o) {
        int i = observers.indexOf(o);
        if (i >= 0) {
            observers.remove(i);
        }
    }

    @Override
    public void notifyObserver() {
        for (Observer o : observers) {
            o.update(temperature, humidity, pressure);
        }
    }

    public void setMeasurements(float temperature, float humidity, float pressure) {
        this.temperature = temperature;
        this.humidity = humidity;
        this.pressure = pressure;
        notifyObserver();
    }
}
```
```java
public interface Observer {
    public void update(float temp, float humidity, float pressure);
}
```
```java
public class CurrentConditionsDisplay implements Observer {
    private Subject weatherData;

    public CurrentConditionsDisplay(Subject weatherData) {
        this.weatherData = weatherData;
        weatherData.resisterObserver(this);
    }

    @Override
    public void update(float temp, float humidity, float pressure) {
        System.out.println("CurrentConditionsDisplay.update:" + temp + " " + humidity + " " + pressure);
    }
}
```
```java
public class StatisticsDisplay implements Observer {
    private Subject weatherData;

    public StatisticsDisplay(Subject weatherData) {
        this.weatherData = weatherData;
        weatherData.resisterObserver(this);
    }

    @Override
    public void update(float temp, float humidity, float pressure) {
        System.out.println("StatisticsDisplay.update:" + temp + " " + humidity + " " + pressure);
    }
}
```
```java
public class WeatherStation {
    public static void main(String[] args) {
        WeatherData weatherData = new WeatherData();
        CurrentConditionsDisplay currentConditionsDisplay = new CurrentConditionsDisplay(weatherData);
        StatisticsDisplay statisticsDisplay = new StatisticsDisplay(weatherData);

        weatherData.setMeasurements(0, 0, 0);
        weatherData.setMeasurements(1, 1, 1);
    }
}
```
æ‰§è¡Œç»“æœ
```html
CurrentConditionsDisplay.update:0.0 0.0 0.0
StatisticsDisplay.update:0.0 0.0 0.0
CurrentConditionsDisplay.update:1.0 1.0 1.0
StatisticsDisplay.update:1.0 1.0 1.0
```

# ç¬¬ 3 ç«  è£…é¥°æ¨¡å¼

**1. é—®é¢˜æè¿°**

è®¾è®¡ä¸åŒç§ç±»çš„é¥®æ–™ï¼Œå¹¶ä¸”æ¯ç§é¥®æ–™å¯ä»¥åŠ¨æ€æ·»åŠ æ–°çš„ææ–™ï¼Œæ¯”å¦‚å¯ä»¥æ·»åŠ ç‰›å¥¶ã€‚è®¡ç®—ä¸€ç§é¥®æ–™çš„ä»·æ ¼ã€‚

**2. æ¨¡å¼å®šä¹‰**

åŠ¨æ€åœ°å°†è´£ä»»é™„åŠ åˆ°å¯¹è±¡ä¸Šã€‚åœ¨æ‰©å±•åŠŸèƒ½ä¸Šï¼Œè£…é¥°è€…æä¾›äº†æ¯”ç»§æ‰¿æ›´æœ‰å¼¹æ€§çš„æ›¿ä»£æ–¹æ¡ˆã€‚

ä¸‹å›¾ä¸­ DarkRoast å¯¹è±¡è¢« Mocha åŒ…è£¹ï¼ŒMocha å¯¹è±¡åˆè¢« Whip åŒ…è£¹ï¼Œå¹¶ä¸”ä»–ä»¬éƒ½ç»§æ‰¿è‡ªç›¸åŒçˆ¶ç±»ï¼Œéƒ½æœ‰ cost() æ–¹æ³•ï¼Œä½†æ˜¯å¤–å±‚å¯¹è±¡çš„ cost() æ–¹æ³•å®ç°è°ƒç”¨äº†å†…å±‚å¯¹è±¡çš„ cost() æ–¹æ³•ã€‚å› æ­¤ï¼Œå¦‚æœè¦åœ¨ DarkRoast ä¸Šæ·»åŠ  Mochaï¼Œé‚£ä¹ˆåªéœ€è¦ç”¨ Mocha åŒ…è£¹ DarkRoastï¼Œå¦‚æœè¿˜éœ€è¦ Whip ï¼Œå°±ç”¨ Whip åŒ…è£¹ Mochaï¼Œæœ€åè°ƒç”¨ cost() æ–¹æ³•èƒ½æŠŠä¸‰ç§å¯¹è±¡çš„ä»·æ ¼éƒ½åŒ…å«è¿›å»ã€‚

![](https://github.com/00000H/notes/blob/master/pics/41a4cb30-f393-4b3b-abe4-9941ccf8fa1f.jpg)

**3. æ¨¡å¼ç±»å›¾**

è£…é¥°è€…å’Œå…·ä½“ç»„ä»¶éƒ½ç»§æ‰¿è‡ªç»„ä»¶ç±»å‹ï¼Œå…¶ä¸­å…·ä½“ç»„ä»¶çš„æ–¹æ³•å®ç°ä¸éœ€è¦ä¾èµ–äºå…¶å®ƒå¯¹è±¡ï¼Œè€Œè£…é¥°è€…æ‹¥æœ‰ä¸€ä¸ªç»„ä»¶ç±»å‹å¯¹è±¡ï¼Œè¿™æ ·å®ƒå¯ä»¥è£…é¥°å…¶å®ƒè£…é¥°è€…æˆ–è€…å…·ä½“ç»„ä»¶ã€‚æ‰€è°“è£…é¥°ï¼Œå°±æ˜¯æŠŠè¿™ä¸ªè£…é¥°è€…å¥—åœ¨è¢«è£…é¥°çš„å¯¹è±¡ä¹‹å¤–ï¼Œä»è€ŒåŠ¨æ€æ‰©å±•è¢«è£…é¥°è€…çš„åŠŸèƒ½ã€‚è£…é¥°è€…çš„æ–¹æ³•æœ‰ä¸€éƒ¨åˆ†æ˜¯è‡ªå·±çš„ï¼Œè¿™å±äºå®ƒçš„åŠŸèƒ½ï¼Œç„¶åè°ƒç”¨è¢«è£…é¥°è€…çš„æ–¹æ³•å®ç°ï¼Œä»è€Œä¹Ÿä¿ç•™äº†è¢«è£…é¥°è€…çš„åŠŸèƒ½ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå…·ä½“ç»„ä»¶åº”å½“æ˜¯è£…é¥°å±‚æ¬¡çš„æœ€ä½å±‚ï¼Œå› ä¸ºåªæœ‰å…·ä½“ç»„ä»¶æœ‰ç›´æ¥å®ç°è€Œä¸éœ€è¦å§”æ‰˜ç»™å…¶å®ƒå¯¹è±¡å»å¤„ç†ã€‚

![](https://github.com/00000H/notes/blob/master/pics/3dc454fb-efd4-4eb8-afde-785b2182caeb.jpg)

**4. é—®é¢˜è§£å†³æ–¹æ¡ˆçš„ç±»å›¾**

![](https://github.com/00000H/notes/blob/master/pics/9c997ac5-c8a7-44fe-bf45-2c10eb773e53.jpg)

**5. è®¾è®¡åŸåˆ™**

**ç±»åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚**ä¹Ÿå°±æ˜¯æ·»åŠ æ–°åŠŸèƒ½æ—¶ä¸éœ€è¦ä¿®æ”¹ä»£ç ã€‚åœ¨æœ¬ç« é—®é¢˜ä¸­è¯¥åŸåˆ™ä½“ç°åœ¨ï¼Œåœ¨é¥®æ–™ä¸­æ·»åŠ æ–°çš„ææ–™ï¼Œè€Œä¸éœ€è¦å»ä¿®æ”¹é¥®æ–™çš„ä»£ç ã€‚è§‚å¯Ÿåˆ™æ¨¡å¼ä¹Ÿç¬¦åˆè¿™ä¸ªåŸåˆ™ã€‚ä¸å¯èƒ½æ‰€æœ‰ç±»éƒ½èƒ½å®ç°è¿™ä¸ªåŸåˆ™ï¼Œåº”å½“æŠŠè¯¥åŸåˆ™åº”ç”¨äºè®¾è®¡ä¸­æœ€æœ‰å¯èƒ½æ”¹å˜çš„åœ°æ–¹ã€‚

**6. Java I/O ä¸­çš„è£…é¥°è€…æ¨¡å¼**

![](https://github.com/00000H/notes/blob/master/pics/2a40042a-03c8-4556-ad1f-72d89f8c555c.jpg)

**7. ä»£ç å®ç°**

```java
public interface Beverage {
    public double cost();
}
```
```java
public class HouseBlend implements Beverage{
    @Override
    public double cost() {
        return 1;
    }
}
```
```java
public class DarkRoast implements Beverage{
    @Override
    public double cost() {
        return 1;
    }
}
```
```java
public abstract class CondimentDecorator implements Beverage{
    protected Beverage beverage;
}
```
```java
public class Mocha extends CondimentDecorator {

    public Mocha(Beverage beverage) {
        this.beverage = beverage;
    }

    @Override
    public double cost() {
        return 1 + beverage.cost();
    }
}
```
```java
public class Milk extends CondimentDecorator {

    public Milk(Beverage beverage) {
        this.beverage = beverage;
    }

    @Override
    public double cost() {
        return 1 + beverage.cost();
    }
}
```
```java
public class StartbuzzCoffee {
    public static void main(String[] args) {
        Beverage beverage = new HouseBlend();
        beverage = new Mocha(beverage);
        beverage = new Milk(beverage);
        System.out.println(beverage.cost());
    }
}
```

è¾“å‡º

```html
3.0
```

# ç¬¬ 4 ç«  å·¥å‚æ¨¡å¼

## 4.1 ç®€å•å·¥å‚

**1. é—®é¢˜æè¿°**

æœ‰ä¸åŒçš„ Pizzaï¼Œæ ¹æ®ä¸åŒçš„æƒ…å†µç”¨ä¸åŒçš„å­ç±»å®ä¾‹åŒ–ä¸€ä¸ª Pizza å¯¹è±¡ã€‚

**2. å®šä¹‰**

ç®€å•å·¥å‚ä¸æ˜¯è®¾è®¡æ¨¡å¼ï¼Œæ›´åƒæ˜¯ä¸€ç§ç¼–ç¨‹ä¹ æƒ¯ã€‚åœ¨å®ä¾‹åŒ–ä¸€ä¸ªè¶…ç±»çš„å¯¹è±¡æ—¶ï¼Œå¯ä»¥ç”¨å®ƒçš„æ‰€æœ‰å­ç±»æ¥è¿›è¡Œå®ä¾‹åŒ–ï¼Œè¦æ ¹æ®å…·ä½“éœ€æ±‚æ¥å†³å®šä½¿ç”¨å“ªä¸ªå­ç±»ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæŠŠå®ä¾‹åŒ–çš„æ“ä½œæ”¾åˆ°å·¥å‚æ¥ä¸­ï¼Œè®©å·¥å‚ç±»æ¥å†³å®šåº”è¯¥ç”¨å“ªä¸ªå­ç±»æ¥å®ä¾‹åŒ–ã€‚è¿™æ ·åšæŠŠå®¢æˆ·å¯¹è±¡å’Œå…·ä½“å­ç±»çš„å®ç°è§£è€¦ï¼Œå®¢æˆ·å¯¹è±¡ä¸å†éœ€è¦çŸ¥é“æœ‰å“ªäº›å­ç±»ä»¥åŠå®ä¾‹åŒ–å“ªä¸ªå­ç±»ã€‚å› ä¸ºå®¢æˆ·ç±»å¾€å¾€æœ‰å¤šä¸ªï¼Œå¦‚æœä¸ä½¿ç”¨ç®€å•å·¥å‚ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„å®¢æˆ·ç±»éƒ½è¦çŸ¥é“æ‰€æœ‰å­ç±»çš„ç»†èŠ‚ï¼Œä¸€æ—¦å­ç±»å‘ç”Ÿæ”¹å˜ï¼Œä¾‹å¦‚å¢åŠ å­ç±»ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„å®¢æˆ·ç±»éƒ½è¦å‘ç”Ÿæ”¹å˜ã€‚

![](https://github.com/00000H/notes/blob/master/pics/c470eb9b-fb05-45c5-8bb7-1057dc3c16de.jpg)

**3. è§£å†³æ–¹æ¡ˆç±»å›¾**

![](https://github.com/00000H/notes/blob/master/pics/dc3e704c-7c57-42b8-93ea-ddd068665964.jpg)


**4. ä»£ç å®ç°**

```java
public interface Pizza {
    public void make();
}
```
```java
public class CheesePizza implements Pizza{
    @Override
    public void make() {
        System.out.println("CheesePizza");
    }
}
```
```java
public class GreekPizza implements Pizza{
    @Override
    public void make() {
        System.out.println("GreekPizza");
    }
}
```
```java
public class SimplePizzaFactory {
    public Pizza createPizza(String type) {
        if (type.equals("cheese")) {
            return new CheesePizza();
        } else if (type.equals("greek")) {
            return new GreekPizza();
        } else {
            throw new UnsupportedOperationException();
        }
    }
}
```
```java
public class PizzaStore {
    public static void main(String[] args) {
        SimplePizzaFactory simplePizzaFactory = new SimplePizzaFactory();
        Pizza pizza = simplePizzaFactory.createPizza("cheese");
        pizza.make();
    }
}
```

è¿è¡Œç»“æœ

```java
CheesePizza
```

## 4.2 å·¥å‚æ–¹æ³•æ¨¡å¼

**1. é—®é¢˜æè¿°**

æ¯ä¸ªåœ°åŒºçš„ Pizza åº—è™½ç„¶ç§ç±»ç›¸åŒï¼Œä½†æ˜¯éƒ½æœ‰è‡ªå·±çš„é£å‘³ï¼Œéœ€è¦å•ç‹¬åŒºåˆ†ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå®¢æˆ·ç‚¹äº†çº½çº¦çš„ cheese ç§ç±»çš„ Pizza å’Œåœ¨èŠåŠ å“¥ç‚¹çš„ç›¸åŒç§ç±»çš„ Pizza æ˜¯ä¸åŒçš„ã€‚

**2. æ¨¡å¼å®šä¹‰**

å®šä¹‰äº†ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œä½†ç”±å­ç±»å†³å®šè¦å®ä¾‹åŒ–çš„ç±»æ˜¯å“ªä¸€ä¸ªã€‚å·¥å‚æ–¹æ³•è®©ç±»æŠŠå®ä¾‹åŒ–æ¨è¿Ÿåˆ°å­ç±»ã€‚

**3. æ¨¡å¼ç±»å›¾**

åœ¨ç®€å•å·¥å‚ä¸­ï¼Œåˆ›å»ºå¯¹è±¡çš„æ˜¯å¦ä¸€ä¸ªç±»ï¼Œè€Œåœ¨å·¥å‚æ–¹æ³•ä¸­ï¼Œæ˜¯ç”±å­ç±»æ¥åˆ›å»ºå¯¹è±¡ã€‚å·¥å‚æ–¹æ³•å¸¸ç”¨åœ¨åœ¨æ¯ä¸ªå­ç±»éƒ½æœ‰è‡ªå·±çš„ä¸€ç»„äº§å“ç±»ã€‚å¯ä»¥ä¸ºæ¯ä¸ªå­ç±»åˆ›å»ºå•ç‹¬çš„ç®€å•å·¥å‚ï¼Œä½†æ˜¯æŠŠç®€å•å·¥å‚ä¸­åˆ›å»ºå¯¹è±¡çš„ä»£ç æ”¾åˆ°å­ç±»ä¸­æ¥å¯ä»¥å‡å°‘ç±»çš„æ•°ç›®ï¼Œå› ä¸ºå­ç±»ä¸ç®—æ˜¯äº§å“ç±»ï¼Œå› æ­¤å®Œå…¨å¯ä»¥è¿™ä¹ˆåšã€‚

![](https://github.com/00000H/notes/blob/master/pics/903093ec-acc8-4f9b-bf2c-b990b9a5390c.jpg)

**4. è§£å†³æ–¹æ¡ˆç±»å›¾**

![](https://github.com/00000H/notes/blob/master/pics/664f8901-5dc7-4644-a072-dad88cc5133a.jpg)

**5. ä»£ç å®ç°**

```java
public interface Pizza {
    public void make();
}
```
```java
public interface PizzaStore {
    public Pizza orderPizza(String item);
}
```
```java
public class NYStyleCheesePizza implements Pizza{
    @Override
    public void make() {
        System.out.println("NYStyleCheesePizza is making..");
    }
}
```
```java
public class NYStyleVeggiePizza implements Pizza {
    @Override
    public void make() {
        System.out.println("NYStyleVeggiePizza is making..");
    }
}
```
```java
public class ChicagoStyleCheesePizza implements Pizza{
    @Override
    public void make() {
        System.out.println("ChicagoStyleCheesePizza is making..");
    }
}
```
```java
public class ChicagoStyleVeggiePizza implements Pizza{
    @Override
    public void make() {
        System.out.println("ChicagoStyleVeggiePizza is making..");
    }
}
```
```java
public class NYPizzaStore implements PizzaStore {
    @Override
    public Pizza orderPizza(String item) {
        Pizza pizza = null;
        if (item.equals("cheese")) {
            pizza = new NYStyleCheesePizza();
        } else if (item.equals("veggie")) {
            pizza = new NYStyleVeggiePizza();
        } else {
            throw new UnsupportedOperationException();
        }
        pizza.make();
        return pizza;
    }
}
```
```java
public class ChicagoPizzaStore implements PizzaStore {
    @Override
    public Pizza orderPizza(String item) {
        Pizza pizza = null;
        if (item.equals("cheese")) {
            pizza = new ChicagoStyleCheesePizza();
        } else if (item.equals("veggie")) {
            pizza = new ChicagoStyleVeggiePizza();
        } else {
            throw new UnsupportedOperationException();
        }
        pizza.make();
        return pizza;
    }
}
```
```java
public class PizzaTestDrive {
    public static void main(String[] args) {
        PizzaStore nyStore = new NYPizzaStore();
        nyStore.orderPizza("cheese");
        PizzaStore chicagoStore = new ChicagoPizzaStore();
        chicagoStore.orderPizza("cheese");
    }
}
```

è¿è¡Œç»“æœ

```html
NYStyleCheesePizza is making..
ChicagoStyleCheesePizza is making..
```

## 4.3 æŠ½è±¡å·¥å‚æ¨¡å¼

**1. è®¾è®¡åŸåˆ™**

**ä¾èµ–å€’ç½®åŸåˆ™**ï¼šè¦ä¾èµ–æŠ½è±¡ï¼Œä¸è¦ä¾èµ–å…·ä½“ç±»ã€‚å¬èµ·æ¥åƒæ˜¯é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œä¸é’ˆå¯¹å®ç°ç¼–ç¨‹ï¼Œä½†æ˜¯è¿™ä¸ªåŸåˆ™è¯´æ˜äº†ï¼šä¸èƒ½è®©é«˜å±‚ç»„ä»¶ä¾èµ–åº•å±‚ç»„ä»¶ï¼Œè€Œä¸”ï¼Œä¸ç®¡é«˜å±‚æˆ–åº•å±‚ç»„ä»¶ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚ä¾‹å¦‚ï¼Œä¸‹å›¾ä¸­ PizzaStore å±äºé«˜å±‚ç»„ä»¶ï¼Œä½†æ˜¯å®ƒä¾èµ–äºåº•å±‚ç»„ä»¶ Pizza çš„å…·ä½“ç±»ã€‚å¦‚æœä¾èµ–çš„æ˜¯ Pizza çš„æŠ½è±¡ç±»ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¸ç”¨å…³å¿ƒ Pizza çš„å…·ä½“å®ç°ç»†èŠ‚ã€‚

![](https://github.com/00000H/notes/blob/master/pics/ddf72ca9-c0be-49d7-ab81-57a99a974c8e.jpg)

**2. æ¨¡å¼å®šä¹‰**

æä¾›ä¸€ä¸ªæ¥å£ï¼Œç”¨äºåˆ›å»ºç›¸å…³æˆ–ä¾èµ–å¯¹è±¡çš„å®¶æ—ï¼Œè€Œä¸éœ€è¦æ˜ç¡®æŒ‡å®šå…·ä½“ç±»ã€‚

**3. æ¨¡å¼ç±»å›¾**

æŠ½è±¡å·¥å‚æ¨¡å¼åˆ›å»ºçš„æ˜¯å¯¹è±¡å®¶æ—ï¼Œä¹Ÿå°±æ˜¯å¾ˆå¤šå¯¹è±¡è€Œä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”è¿™äº›å¯¹è±¡æ˜¯ç›¸å…³çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¿…é¡»ä¸€èµ·åˆ›å»ºå‡ºæ¥ã€‚è€Œå·¥å‚æ¨¡å¼åªæ˜¯ç”¨äºåˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿™å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼æœ‰å¾ˆå¤§ä¸åŒã€‚å¹¶ä¸”ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼ä¹Ÿç”¨åˆ°äº†å·¥å‚æ¨¡å¼æ¥åˆ›å»ºå•ä¸€å¯¹è±¡ï¼Œåœ¨ç±»å›¾å·¦éƒ¨ï¼ŒAbstractFactory ä¸­çš„ CreateProductA å’Œ CreateProductB æ–¹æ³•éƒ½æ˜¯è®©å­ç±»æ¥å®ç°ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•å•ç‹¬æ¥çœ‹å°±æ˜¯åœ¨åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ç¬¦åˆå·¥å‚æ¨¡å¼çš„å®šä¹‰ã€‚è‡³äºåˆ›å»ºå¯¹è±¡çš„å®¶æ—è¿™ä¸€æ¦‚å¿µæ˜¯åœ¨ Client ä½“ç°ï¼ŒClient è¦é€šè¿‡ AbstractFactory åŒæ—¶è°ƒç”¨ä¸¤ä¸ªæ–¹æ³•æ¥åˆ›å»ºå‡ºä¸¤ä¸ªå¯¹è±¡ï¼Œåœ¨è¿™é‡Œè¿™ä¸¤ä¸ªå¯¹è±¡å°±æœ‰å¾ˆå¤§çš„ç›¸å…³æ€§ï¼ŒClient éœ€è¦è¿™ä¸¤ä¸ªå¯¹è±¡çš„åä½œæ‰èƒ½å®Œæˆä»»åŠ¡ã€‚ä»é«˜å±‚æ¬¡æ¥çœ‹ï¼ŒæŠ½è±¡å·¥å‚ä½¿ç”¨äº†ç»„åˆï¼Œå³ Cilent ç»„åˆäº† AbstractFactory ï¼Œè€Œå·¥å‚æ¨¡å¼ä½¿ç”¨äº†ç»§æ‰¿ã€‚

![](https://github.com/00000H/notes/blob/master/pics/d301774f-e0d2-41f3-95f4-bfe39859b52e.jpg)

**4. è§£å†³æ–¹æ¡ˆç±»å›¾**

![](https://github.com/00000H/notes/blob/master/pics/8785dabd-1285-4bd0-b3aa-b05cc060a24a.jpg)

**5. ä»£ç å®ç°**

```java
public interface Dough {
    public String doughType();
}
```
```java
public class ThickCrustDough implements Dough{

    @Override
    public String doughType() {
        return "ThickCrustDough";
    }
}
```
```java
public class ThinCrustDough implements Dough {
    @Override
    public String doughType() {
        return "ThinCrustDough";
    }
}
```
```java
public interface Sauce {
    public String sauceType();
}
```
```java
public class MarinaraSauce implements Sauce {
    @Override
    public String sauceType() {
        return "MarinaraSauce";
    }
}
```
```java
public class PlumTomatoSauce implements Sauce {
    @Override
    public String sauceType() {
        return "PlumTomatoSauce";
    }
}
```
```java
public interface PizzaIngredientFactory {
    public Dough createDough();
    public Sauce createSauce();
}
```
```java
public class NYPizzaIngredientFactory implements PizzaIngredientFactory{
    @Override
    public Dough createDough() {
        return new ThickCrustDough();
    }

    @Override
    public Sauce createSauce() {
        return new MarinaraSauce();
    }
}
```
```java
public class ChicagoPizzaIngredientFactory implements PizzaIngredientFactory{
    @Override
    public Dough createDough() {
        return new ThinCrustDough();
    }

    @Override
    public Sauce createSauce() {
        return new PlumTomatoSauce();
    }
}
```
```java
public class NYPizzaStore {
    private PizzaIngredientFactory ingredientFactory;

    public NYPizzaStore() {
        ingredientFactory = new NYPizzaIngredientFactory();
    }

    public void makePizza() {
        Dough dough = ingredientFactory.createDough();
        Sauce sauce = ingredientFactory.createSauce();
        System.out.println(dough.doughType());
        System.out.println(sauce.sauceType());
    }
}
```
```java
public class NYPizzaStoreTestDrive {
    public static void main(String[] args) {
        NYPizzaStore nyPizzaStore = new NYPizzaStore();
        nyPizzaStore.makePizza();
    }
}
```

è¿è¡Œç»“æœ

```html
ThickCrustDough
MarinaraSauce
```

# ç¬¬ 5 ç«  å•ä»¶æ¨¡å¼

**1. æ¨¡å¼å®šä¹‰**

ç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ã€‚

**2. æ¨¡å¼ç±»å›¾**

å•ä»¶æ¨¡å¼çš„ Java å®ç°ç”¨ä¸€ä¸ªç§æœ‰æ„é€ å™¨ã€ä¸€ä¸ªç§æœ‰é™æ€å˜é‡ä»¥åŠä¸€ä¸ªå…¬æœ‰é™æ€å‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›ç§æœ‰å˜é‡ï¼Œä½¿å¾—æ‰€æœ‰é€šè¿‡è¯¥å‡½æ•°è·å–çš„å¯¹è±¡éƒ½æŒ‡å‘è¿™ä¸ªå”¯ä¸€çš„ç§æœ‰é™æ€å˜é‡ã€‚

![](https://github.com/00000H/notes/blob/master/pics/59aff6c1-8bc5-48e4-9e9c-082baeb2f274.jpg)

**3. ç»å…¸å®ç°**

ä»¥ä¸‹å®ç°ä¸­ï¼Œç§æœ‰é™æ€å˜é‡è¢«å»¶è¿ŸåŒ–å®ä¾‹åŒ–ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œå¦‚æœæ²¡æœ‰ç”¨åˆ°è¯¥ç±»ï¼Œé‚£ä¹ˆå°±ä¸ä¼šåˆ›å»ºè¯¥ç§æœ‰é™æ€å˜é‡ï¼Œä»è€ŒèŠ‚çº¦èµ„æºã€‚è¿™ä¸ªå®ç°åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹æ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºå¤šä¸ªçº¿ç¨‹èƒ½å¤ŸåŒæ—¶è¿›å…¥ if(uniqueInstance == null) å†…çš„è¯­å¥å—ï¼Œé‚£ä¹ˆå°±ä¼šå¤šæ¬¡å®ä¾‹åŒ– uniqueInstance ç§æœ‰é™æ€å˜é‡ã€‚

```java
public class Singleton {

    private static Singleton uniqueInstance;

    private Singleton() {
    }

    public static Singleton getUniqueInstance() {
        if (uniqueInstance == null) {
            uniqueInstance = new Singleton();
        }
        return uniqueInstance;
    }
}
```

**4. çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜çš„è§£å†³æ–¹æ¡ˆä¸€**

åªéœ€è¦å¯¹ getUniqueInstance() æ–¹æ³•åŠ é”ï¼Œå°±èƒ½è®©è¯¥æ–¹æ³•ä¸€æ¬¡åªèƒ½ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œä»è€Œé¿å…äº†å¯¹ uniqueInstance å˜é‡è¿›è¡Œå¤šæ¬¡å®ä¾‹åŒ–çš„é—®é¢˜ã€‚ä½†æ˜¯è¿™æ ·æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ä¸€æ¬¡åªèƒ½ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ï¼Œæ€§èƒ½ä¸Šä¼šæœ‰ä¸€å®šçš„æµªè´¹ã€‚

```java
    public static synchronized Singleton getUniqueInstance() {
        if (uniqueInstance == null) {
            uniqueInstance = new Singleton();
        }
        return uniqueInstance;
    }
```

**5. çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜çš„è§£å†³æ–¹æ¡ˆäºŒ**

ä¸ç”¨å»¶è¿Ÿå®ä¾‹åŒ–ï¼Œé‡‡ç”¨ç›´æ¥å®ä¾‹åŒ–ã€‚

```java
private static Singleton uniqueInstance = new Singleton();
```

**6. çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜çš„è§£å†³æ–¹æ¡ˆä¸‰**

è€ƒè™‘ç¬¬ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå®ƒæ˜¯ç›´æ¥å¯¹ getUniqueInstance() æ–¹æ³•è¿›è¡ŒåŠ é”ï¼Œè€Œå®é™…ä¸Šåªéœ€è¦å¯¹ uniqueInstance = new Singleton(); è¿™æ¡è¯­å¥åŠ é”å³å¯ã€‚ä½¿ç”¨ä¸¤ä¸ªæ¡ä»¶è¯­å¥æ¥åˆ¤æ–­ uniqueInstance æ˜¯å¦å·²ç»å®ä¾‹åŒ–ï¼Œå¦‚æœæ²¡æœ‰å®ä¾‹åŒ–æ‰éœ€è¦åŠ é”ã€‚

```java
public class Singleton {

    private volatile static Singleton uniqueInstance;

    private Singleton() {
    }

    public static synchronized Singleton getUniqueInstance() {
        if (uniqueInstance == null) {
            synchronized (Singleton.class) {
                if (uniqueInstance == null) {
                    uniqueInstance = new Singleton();
                }
            }
        }
        return uniqueInstance;
    }
}
```

# ç¬¬ 6 ç«  å‘½ä»¤æ¨¡å¼

**1. é—®é¢˜æè¿°**

è®¾è®¡ä¸€ä¸ªé¥æ§å™¨ï¼Œå®ƒæœ‰å¾ˆå¤šæŒ‰é’®ï¼Œæ¯ä¸ªæŒ‰é’®å¯ä»¥å‘èµ·ä¸€ä¸ªå‘½ä»¤ï¼Œè®©ä¸€ä¸ªå®¶ç”µå®Œæˆç›¸åº”æ“ä½œã€‚æœ‰éå¸¸å¤šçš„å®¶ç”µï¼Œå¹¶ä¸”ä¹Ÿä¼šå¢åŠ å®¶ç”µã€‚

![](https://github.com/00000H/notes/blob/master/pics/7b8f0d8e-a4fa-4c9d-b9a0-3e6a11cb3e33.jpg)

![](https://github.com/00000H/notes/blob/master/pics/c3ca36b2-8459-4cf1-98b0-cc95a0e94f20.jpg)

**2. æ¨¡å¼å®šä¹‰**

å°†å‘½ä»¤å°è£…æˆå¯¹è±¡ï¼Œä»¥ä¾¿ä½¿ç”¨ä¸åŒçš„å‘½ä»¤æ¥å‚æ•°åŒ–å…¶å®ƒå¯¹è±¡ã€‚

**3. æ¨¡å¼ç±»å›¾**

![](https://github.com/00000H/notes/blob/master/pics/1e09d75f-6268-4425-acf8-8ecd1b4a0ef3.jpg)

**4. è§£å†³æ–¹æ¡ˆç±»å›¾**

Invoker æ˜¯é¥æ§å™¨ï¼Œå®ƒå¯ä»¥è®¾ç½®å‘½ä»¤ï¼Œå¹¶ä¸”è°ƒç”¨å‘½ä»¤å¯¹è±¡çš„ execute() æ–¹æ³•ã€‚Receiver æ˜¯ç”µç¯ï¼Œæ˜¯å‘½ä»¤çœŸæ­£çš„æ‰§è¡Œè€…ã€‚ConcreteCommand ç±»ç»„åˆäº†ä¸€ä¸ª Receiver å¯¹è±¡ï¼Œå‘½ä»¤çš„æ‰§è¡Œå§”æ‰˜ç»™ Receiver å¯¹è±¡æ¥å¤„ç†ï¼Œä¹Ÿå°±æ˜¯ LightOnCommand å‘½ä»¤çš„ excute æ–¹æ³•å§”æ‰˜ç»™ Light å¯¹è±¡æ¥å¤„ç†ï¼ŒLight å¯¹è±¡é€šè¿‡è°ƒç”¨ on() æ–¹æ³•æ¥å®Œæˆæ“ä½œã€‚Invoker ä¸æ˜¯ Client å¯¹è±¡ï¼Œæ˜¯å› ä¸ºå‘½ä»¤çš„åˆ›å»ºä¸æ˜¯åœ¨ Invoker ä¸­å®Œæˆçš„ï¼Œå› æ­¤éœ€è¦é¢å¤–çš„ Client å¯¹è±¡æ¥å¤„ç†è¿™äº›æ“ä½œã€‚

![](https://github.com/00000H/notes/blob/master/pics/5ef94f62-98ce-464d-a646-842d9c72c8b8.jpg)

**5. ä»£ç å®ç°**

```java
public interface Command {
    public void execute();
}
```
```java
public class Light {

    public void on() {
        System.out.println("Light is on!");
    }

    public void off() {
        System.out.println("Light is off!");
    }
}
```
```java
public class LightOnCommand implements Command{
    Light light;

    public LightOnCommand(Light light) {
        this.light = light;
    }

    @Override
    public void execute() {
        light.on();
    }
}
```
```java
/**
 * é¥æ§å™¨ç±»
 */
public class SimpleRemoteControl {
    Command slot;

    public SimpleRemoteControl() {

    }

    public void setCommand(Command command) {
        this.slot = command;
    }

    public void buttonWasPressed() {
        slot.execute();
    }

}
```
```java
public class RemoteLoader {
    public static void main(String[] args) {
        SimpleRemoteControl remote = new SimpleRemoteControl();
        Light light = new Light();
        LightOnCommand lightOnCommand = new LightOnCommand(light);
        remote.setCommand(lightOnCommand);
        remote.buttonWasPressed();
    }
}
```

è¾“å‡º

```html
Light is on!
```

# ç¬¬ 7 ç«  é€‚é…å™¨æ¨¡å¼ä¸å¤–è§‚æ¨¡å¼

## 7.1 é€‚é…å™¨æ¨¡å¼

**1. æ¨¡å¼å®šä¹‰**

å°†ä¸€ä¸ªç±»çš„æ¥å£ï¼Œè½¬æ¢ä¸ºå®¢æˆ·æœŸæœ›çš„å¦ä¸€ä¸ªæ¥å£ã€‚é€‚é…å™¨è®©åŸæœ¬ä¸å…¼å®¹çš„ç±»å¯ä»¥åˆä½œæ— é—´ã€‚

![](https://github.com/00000H/notes/blob/master/pics/8e8ba824-7a9e-4934-a212-e6a41dcc1602.jpg)

**2. æ¨¡å¼ç±»å›¾**

æœ‰ä¸¤ç§é€‚é…å™¨æ¨¡å¼çš„å®ç°ï¼Œä¸€ç§æ˜¯å¯¹è±¡æ–¹å¼ï¼Œä¸€ç§æ˜¯ç±»æ–¹å¼ã€‚å¯¹è±¡æ–¹å¼æ˜¯é€šè¿‡ç»„åˆçš„æ–¹æ³•ï¼Œè®©é€‚é…å™¨ç±»ï¼ˆAdapterï¼‰æ‹¥æœ‰ä¸€ä¸ªå¾…é€‚é…çš„å¯¹è±¡ï¼ˆAdapteeï¼‰ï¼Œä»è€ŒæŠŠç›¸åº”çš„å¤„ç†å§”æ‰˜ç»™å¾…é€‚é…çš„å¯¹è±¡ã€‚ç±»æ–¹å¼ç”¨åˆ°å¤šé‡ç»§æ‰¿ï¼ŒAdapter å¯ä»¥çœ‹æˆ Target å’Œ Adaptee ç±»å‹ï¼Œå…ˆæŠŠå®ƒå½“æˆ Adaptee ç±»å‹ç„¶åå®ä¾‹åŒ–ä¸€ä¸ª Adapter å¯¹è±¡ï¼Œå†æŠŠå®ƒå½“æˆ Target ç±»å‹çš„ï¼Œè¿™æ · Client å°±å¯ä»¥æŠŠè¿™ä¸ªå¯¹è±¡å½“æˆ Target çš„å¯¹è±¡æ¥å¤„ç†ã€‚

![](https://github.com/00000H/notes/blob/master/pics/253bd869-ea48-4092-9aed-6906ccb2f3b0.jpg)

![](https://github.com/00000H/notes/blob/master/pics/a797959a-0ed5-475b-8d97-df157c672019.jpg)

**3. é—®é¢˜æè¿°**

è®©é¸­å­ï¼ˆDuckï¼‰é€‚é…ç«é¸¡ï¼ˆTurkeyï¼‰ï¼ŒDuck æœ‰ quack() æ–¹æ³•ï¼Œè€Œ Turkey åªæœ‰ gobble() æ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯è¦è®© Turkey ä¹Ÿæœ‰ Duck çš„ quack() æ–¹æ³•ã€‚

**4. è§£å†³æ–¹æ¡ˆç±»å›¾**

![](https://github.com/00000H/notes/blob/master/pics/1a511c76-bb6b-40ab-b8aa-39eeb619d673.jpg)

**5. ä»£ç å®ç°**

```java
public interface Duck {
    public void quack();
    public void fly();
}
```
```java
public interface Turkey {
    public void gobble();
    public void fly();
}
```
```java
public class WildTurkey implements Turkey{
    @Override
    public void gobble() {
        System.out.println("gobble!");
    }

    @Override
    public void fly() {
        System.out.println("fly!");
    }
}
```
```java
public class TurkeyAdapter implements Duck{
    Turkey turkey;

    public TurkeyAdapter(Turkey turkey) {
        this.turkey = turkey;
    }

    @Override
    public void quack() {
        turkey.gobble();
    }

    @Override
    public void fly() {
        turkey.fly();
    }
}
```
```java
public class DuckTestDrive {
    public static void main(String[] args) {
        Turkey turkey = new WildTurkey();
        Duck duck = new TurkeyAdapter(turkey);
        duck.quack();
        duck.fly();
    }
}
```

è¿è¡Œç»“æœ
```html
gobble!
fly!
```

## 7.2 å¤–è§‚æ¨¡å¼

**1. æ¨¡å¼å®šä¹‰**

æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œç”¨æ¥è®¿é—®å­ç³»ç»Ÿä¸­çš„ä¸€ç¾¤æ¥å£ã€‚å¤–è§‚å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè®©å­ç³»ç»Ÿæ›´å®¹æ˜“ä½¿ç”¨ã€‚

**2. æ¨¡å¼ç±»å›¾**

![](https://github.com/00000H/notes/blob/master/pics/78f2314e-2643-41df-8f3d-b7e28294094b.jpg)

**3. é—®é¢˜æè¿°**

å®¶åº­å½±é™¢ä¸­æœ‰ä¼—å¤šç”µå™¨ï¼Œå½“è¦è¿›è¡Œè§‚çœ‹ç”µå½±æ—¶éœ€è¦å¯¹å¾ˆå¤šç”µå™¨è¿›è¡Œæ“ä½œã€‚è¦æ±‚ç®€åŒ–è¿™äº›æ“ä½œï¼Œä½¿å¾—å®¶åº­å½±é™¢ç±»åªæä¾›ä¸€ä¸ªç®€åŒ–çš„æ¥å£ï¼Œä¾‹å¦‚æä¾›ä¸€ä¸ªçœ‹ç”µå½±çš„æ¥å£è€Œä¸ç”¨å…·ä½“æ“ä½œä¼—å¤šç”µå™¨ã€‚

![](https://github.com/00000H/notes/blob/master/pics/106f5585-b2e7-4718-be5d-3b322d1ef42a.jpg)

**4. è§£å†³æ–¹æ¡ˆç±»å›¾**

![](https://github.com/00000H/notes/blob/master/pics/25387681-89f8-4365-a2fa-83b86449ee84.jpg)

**5. è®¾è®¡åŸåˆ™**

**æœ€å°‘çŸ¥è¯†åŸåˆ™**ï¼šåªå’Œä½ çš„å¯†å‹è°ˆè¯ã€‚ä¹Ÿå°±æ˜¯åº”å½“ä½¿å¾—å®¢æˆ·å¯¹è±¡æ‰€éœ€è¦äº¤äº’çš„å¯¹è±¡åº”å½“å°½å¯èƒ½å°‘ã€‚

# ç¬¬ 8 ç«  æ¨¡æ¿æ–¹æ³•æ¨¡å¼

**1. æ¨¡å¼å®šä¹‰**

åœ¨ä¸€ä¸ªæ–¹æ³•ä¸­å®šä¹‰ä¸€ä¸ªç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚

æ¨¡æ¿æ–¹æ³•ä½¿å¾—å­ç±»å¯ä»¥åœ¨ä¸æ”¹å˜ç®—æ³•ç»“æ„çš„æƒ…å†µä¸‹ï¼Œé‡æ–°å®šä¹‰ç®—æ³•ä¸­çš„æŸäº›æ­¥éª¤ã€‚

**2. æ¨¡å¼ç±»å›¾**

æ¨¡æ¿æ–¹æ³• templateMethod() å®šä¹‰äº†ç®—æ³•çš„éª¨æ¶ï¼Œç¡®å®šäº† primitiveOperation1() å’Œ primitiveOperation2() æ–¹æ³•æ‰§è¡Œçš„é¡ºåºï¼Œè€Œ primitiveOperation1() å’Œ primitiveOperation2() è®©å­ç±»å»å…·ä½“å®ç°ã€‚

![](https://github.com/00000H/notes/blob/master/pics/ed62f400-192c-4185-899b-187958201f0c.jpg)

**3. é—®é¢˜æè¿°**

å†²å’–å•¡å’Œå†²èŒ¶éƒ½æœ‰ç±»ä¼¼çš„æµç¨‹ï¼Œä½†æ˜¯æŸäº›æ­¥éª¤ä¼šæœ‰ç‚¹ä¸ä¸€æ ·ã€‚

![](https://github.com/00000H/notes/blob/master/pics/d8f873fc-00bc-41ee-a87c-c1b4c0172844.png)

**4. è§£å†³æ–¹æ¡ˆç±»å›¾**

![](https://github.com/00000H/notes/blob/master/pics/aa20c123-b6b5-432a-83d3-45dc39172192.jpg)

**5. è®¾è®¡åŸåˆ™**

**å¥½è±ååŸåˆ™**ï¼šåˆ«è°ƒç”¨ï¼ˆæ‰“ç”µè¯ç»™ï¼‰æˆ‘ä»¬ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨ï¼ˆæ‰“ç”µè¯ç»™ï¼‰ä½ ã€‚è¿™ä¸€åŸåˆ™å¯ä»¥é˜²æ­¢ä¾èµ–è…è´¥ï¼Œå³é˜²æ­¢é«˜å±‚ç»„ä»¶ä¾èµ–åº•å±‚ç»„ä»¶ï¼Œåº•å±‚ç»„ä»¶åˆä¾èµ–é«˜å±‚ç»„ä»¶ã€‚è¯¥åŸåˆ™åœ¨æ¨¡æ¿æ–¹æ³•çš„ä½“ç°ä¸ºï¼Œåªæœ‰çˆ¶ç±»ä¼šè°ƒç”¨å­ç±»ï¼Œå­ç±»ä¸ä¼šè°ƒç”¨çˆ¶ç±»ã€‚

**6. é’©å­**

é’©å­ï¼ˆhockï¼‰ï¼šæŸäº›æ­¥éª¤åœ¨ä¸åŒå®ç°ä¸­å¯æœ‰å¯æ— ï¼Œå¯ä»¥å…ˆå®šä¹‰ä¸€ä¸ªä»€ä¹ˆéƒ½ä¸åšçš„æ–¹æ³•ï¼ŒæŠŠå®ƒåŠ åˆ°æ¨¡æ¿æ–¹æ³• templteMethod() ä¸­ï¼Œå¦‚æœå­ç±»éœ€è¦å®ƒå°±è¦†ç›–é»˜è®¤å®ç°å¹¶åŠ ä¸Šè‡ªå·±çš„å®ç°ã€‚

**7. ä»£ç å®ç°**

```java
public abstract class CaffeineBeverage {

    final void prepareRecipe(){
        boilWater();
        brew();
        pourInCup();
        addCondiments();
    }

    abstract void brew();

    abstract void addCondiments();

    void boilWater(){
        System.out.println("boilWater");
    }

    void pourInCup(){
        System.out.println("pourInCup");
    }
}
```
```java
public class Coffee extends CaffeineBeverage{
    @Override
    void brew() {
        System.out.println("Coffee.brew");
    }

    @Override
    void addCondiments() {
        System.out.println("Coffee.addCondiments");
    }
}
```
```java
public class Tea extends CaffeineBeverage{
    @Override
    void brew() {
        System.out.println("Tea.brew");
    }

    @Override
    void addCondiments() {
        System.out.println("Tea.addCondiments");
    }
}
```
```java
public class CaffeineBeverageTestDrive {
    public static void main(String[] args) {
        CaffeineBeverage caffeineBeverage = new Coffee();
        caffeineBeverage.prepareRecipe();
        System.out.println("-----------");
        caffeineBeverage = new Tea();
        caffeineBeverage.prepareRecipe();
    }
}
```

è¿è¡Œç»“æœ

```html
boilWater
Coffee.brew
pourInCup
Coffee.addCondiments
-----------
boilWater
Tea.brew
pourInCup
Tea.addCondiments
```

# ç¬¬ 9 ç«  è¿­ä»£å™¨å’Œç»„åˆæ¨¡å¼

## 9.1 è¿­ä»£å™¨æ¨¡å¼

**1. æ¨¡å¼å®šä¹‰**

æä¾›ä¸€ç§é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ çš„æ–¹æ³•ï¼Œè€Œåˆä¸æš´éœ²å…¶å†…éƒ¨çš„è¡¨ç¤ºã€‚

**2. æ¨¡å¼ç±»å›¾**

å®¢æˆ·ç±»æ‹¥æœ‰ä¸€ä¸ªèšåˆå¯¹è±¡å’Œè¿­ä»£å™¨å¯¹è±¡ï¼Œè¿­ä»£å™¨å¯¹è±¡æ˜¯èšåˆå¯¹è±¡ç”Ÿæˆçš„ã€‚åªéœ€è¦è¿­ä»£å™¨å®šä¹‰å¥½ç§»åŠ¨çš„æ“ä½œï¼Œå°±å¯ä»¥è®©èšåˆå¯¹è±¡èƒ½å¤Ÿé¡ºåºéå†ã€‚

![](https://github.com/00000H/notes/blob/master/pics/439deca7-fed0-4c89-87e5-7088d10f1fdb.jpg)

**3. ä»£ç å®ç°**

```java
public class Aggregate {

    private int[] items;

    public Aggregate() {
        items = new int[10];
        for (int i = 0; i < items.length; i++) {
            items[i] = i;
        }
    }

    public Iterator createIterator() {
        return new ConcreteIterator(items);
    }

}
```
```java
public interface Iterator {
    boolean hasNext();
    int next();
}
```
```java
public class ConcreteIterator implements Iterator {

    private int[] items;
    private int position = 0;

    public ConcreteIterator(int[] items) {
        this.items = items;
    }

    @Override
    public boolean hasNext() {
        return position < items.length;
    }

    @Override
    public int next() {
        return items[position++];
    }
}
```
```java
public class Client {
    public static void main(String[] args) {
        Aggregate aggregate = new Aggregate();
        Iterator iterator = aggregate.createIterator();
        while(iterator.hasNext()){
            System.out.println(iterator.next());
        }
    }
}
```
è¿è¡Œç»“æœ
```html
0
1
2
3
4
5
6
7
8
9
```

## 9.2 Java å†…ç½®çš„è¿­ä»£å™¨

**1. å®ç°æ¥å£**

Java ä¸­å·²ç»æœ‰äº† Iterator æ¥å£ï¼Œåœ¨ä½¿ç”¨ Java å®ç°æ—¶ï¼Œéœ€è¦è®©èšåˆå¯¹è±¡å®ç° Iterable æ¥å£ï¼Œè¯¥æ¥å£æœ‰ä¸€ä¸ª iterator() æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª Iterator å¯¹è±¡ã€‚ä½¿ç”¨ Java å†…ç½®çš„è¿­ä»£å™¨å®ç°ï¼Œå®¢æˆ·å¯¹è±¡å¯ä»¥ä½¿ç”¨ foreach å¾ªç¯æ¥éå†èšåˆå¯¹è±¡ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚

**2. ä»£ç å®ç°**

```java
import java.util.Iterator;

public class Aggregate implements Iterable<Integer>{

    private int[] items;

    public Aggregate() {
        items = new int[10];
        for (int i = 0; i < items.length; i++) {
            items[i] = i;
        }
    }

    @Override
    public Iterator<Integer> iterator() {
        return new ConcreteIterator(items);
    }
}
```
```java
import java.util.Iterator;

public class ConcreteIterator implements Iterator<Integer> {

    private int[] items;
    private int position = 0;

    public ConcreteIterator(int[] items) {
        this.items = items;
    }

    @Override
    public boolean hasNext() {
        return position < items.length;
    }

    @Override
    public Integer next() {
        return items[position++];
    }
}
```
```java
public class Client {
    public static void main(String[] args) {
        Aggregate aggregate = new Aggregate();
        for (int item : aggregate) {
            System.out.println(item);
        }
    }
}
```

## 9.3 ç»„åˆæ¨¡å¼

**1. è®¾è®¡åŸåˆ™**

ä¸€ä¸ªç±»åº”è¯¥åªæœ‰ä¸€ä¸ªå¼•èµ·æ”¹å˜çš„åŸå› ã€‚

**2. æ¨¡å¼å®šä¹‰**

å…è®¸å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„æ¥è¡¨ç°â€œæ•´ä½“ / éƒ¨åˆ†â€å±‚æ¬¡ç»“æ„ã€‚

ç»„åˆèƒ½è®©å®¢æˆ·ä»¥ä¸€è‡´çš„æ–¹å¼å¤„ç†ä¸ªåˆ«å¯¹è±¡ä»¥åŠå¯¹è±¡ç»„åˆã€‚

**3. æ¨¡å¼ç±»å›¾**

ç”±äºç»„åˆï¼ˆCompositeï¼‰ç±»æ‹¥æœ‰ä¸€ä¸ªç»„ä»¶ï¼ˆComponentï¼‰å¯¹è±¡ï¼Œå› æ­¤ç»„åˆå¯¹è±¡ä½äºæ ‘å½¢ç»“æ„çš„ä¸­é—´ï¼Œå®ƒè¿˜å¯ä»¥ç»§ç»­æ“ä½œè¿™ä¸ªç»„ä»¶å¯¹è±¡ï¼Œå¹¶å¿½ç•¥ç»„ä»¶å¯¹è±¡çš„å…·ä½“ç±»å‹ã€‚

![](https://github.com/00000H/notes/blob/master/pics/f99c019e-7e91-4c2e-b94d-b031c402dcb5.jpg)

**4. ä»£ç å®ç°**

```java
public abstract class Component {
    protected String name;

    public Component(String name) {
        this.name = name;
    }

    abstract public void addChild(Component component);

    public void print() {
        print(0);
    }

    abstract protected void print(int level);
}
```
```java
public class Leaf extends Component {
    public Leaf(String name) {
        super(name);
    }

    @Override
    public void addChild(Component component) {
        throw new UnsupportedOperationException(); // ç‰ºç‰²é€æ˜æ€§æ¢å–å•ä¸€èŒè´£åŸåˆ™ , è¿™æ ·å°±ä¸ç”¨è€ƒè™‘æ˜¯å¶å­èŠ‚ç‚¹è¿˜æ˜¯ç»„åˆèŠ‚ç‚¹
    }

    @Override
    protected void print(int level) {
        for (int i = 0; i < level; i++) {
            System.out.print("--");
        }
        System.out.println("left:" + name);
    }
}
```
```java
import java.util.ArrayList;
import java.util.List;

public class Composite extends Component {

    private List<Component> childs;

    public Composite(String name) {
        super(name);
        childs = new ArrayList<>();
    }

    @Override
    public void addChild(Component component) {
        childs.add(component);
    }

    @Override
    protected void print(int level) {
        for (int i = 0; i < level; i++) {
            System.out.print("--");
        }
        System.out.println("Composite:" + name);
        for (Component component : childs) {
            component.print(level + 1);
        }
    }
}
```
```java
public class Client {
    public static void main(String[] args) {
        Composite root = new Composite("root");
        Component node1 = new Leaf("1");
        Component node2 = new Composite("2");
        Component node3 = new Leaf("3");
        root.addChild(node1);
        root.addChild(node2);
        root.addChild(node3);
        Component node21 = new Leaf("21");
        Component node22 = new Composite("22");
        node2.addChild(node21);
        node2.addChild(node22);
        Component node221 = new Leaf("221");
        node22.addChild(node221);
        root.print();
    }
}
```
è¿è¡Œç»“æœ

```html
Composite:root
--left:1
--Composite:2
----left:21
----Composite:22
------left:221
--left:3
```

# ç¬¬ 10 ç«  çŠ¶æ€æ¨¡å¼

**1. æ¨¡å¼å®šä¹‰**

å…è®¸å¯¹è±¡åœ¨å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥å¥½åƒä¿®æ”¹äº†å®ƒçš„ç±»ã€‚

çŠ¶æ€æ¨¡å¼çš„ç±»å›¾å’Œç­–ç•¥æ¨¡å¼ä¸€æ ·ï¼Œå¹¶ä¸”éƒ½æ˜¯èƒ½å¤ŸåŠ¨æ€æ”¹å˜å¯¹è±¡çš„è¡Œä¸ºã€‚ä½†æ˜¯çŠ¶æ€æ¨¡å¼æ˜¯é€šè¿‡çŠ¶æ€å¯¹è±¡çš„çŠ¶æ€è½¬ç§»æ¥æ”¹å˜å®¢æˆ·å¯¹è±¡ç»„åˆçš„çŠ¶æ€å¯¹è±¡ï¼Œè€Œç­–ç•¥æ¨¡å¼æ˜¯é€šè¿‡å®¢æˆ·å¯¹è±¡æœ¬èº«çš„å†³ç­–æ¥æ”¹å˜ç»„åˆçš„ç­–ç•¥å¯¹è±¡ã€‚ä¾‹å¦‚ï¼ŒçŠ¶æ€æ¨¡å¼ä¸‹ï¼Œå®¢æˆ·å¯¹è±¡å§”æ‰˜çŠ¶æ€å¯¹è±¡è¿›è¡Œä¸€ä¸ªå¤„ç†æ“ä½œï¼Œé‚£ä¹ˆçŠ¶æ€å¯¹è±¡æœ‰å¯èƒ½å‘ç”ŸçŠ¶æ€è½¬ç§»ï¼Œä½¿å¾—å®¢æˆ·å¯¹è±¡æ‹¥æœ‰çš„çŠ¶æ€å¯¹è±¡å‘ç”Ÿæ”¹å˜ã€‚çŠ¶æ€å¯¹è±¡ç»„åˆäº†å®¢æˆ·å¯¹è±¡ï¼ŒçŠ¶æ€è½¬ç§»æ˜¯çŠ¶æ€å¯¹è±¡é€šè¿‡æ”¹å˜å®¢æˆ·å¯¹è±¡æ‰€ç»„åˆçš„çŠ¶æ€å¯¹è±¡å®ç°çš„ã€‚

**2. æ¨¡å¼ç±»å›¾**

![](https://github.com/00000H/notes/blob/master/pics/c28fd93a-0d55-4a19-810f-72652feee00d.jpg)

**3. é—®é¢˜æè¿°**

ç³–æœé”€å”®æœºæœ‰å¤šç§çŠ¶æ€ï¼Œæ¯ç§çŠ¶æ€ä¸‹é”€å”®æœºæœ‰ä¸åŒçš„è¡Œä¸ºï¼ŒçŠ¶æ€å¯ä»¥å‘ç”Ÿè½¬ç§»ï¼Œä½¿å¾—é”€å”®æœºçš„è¡Œä¸ºä¹Ÿå‘ç”Ÿæ”¹å˜ã€‚

![](https://github.com/00000H/notes/blob/master/pics/f7d880c9-740a-4a16-ac6d-be502281b4b2.jpg)

**4. ç›´æ¥è§£å†³æ–¹æ¡ˆ**

åœ¨ç³–æœæœºçš„æ¯ä¸ªæ“ä½œå‡½æ•°é‡Œé¢ï¼Œåˆ¤æ–­å½“å‰çš„çŠ¶æ€ï¼Œæ ¹æ®ä¸åŒçš„çŠ¶æ€è¿›è¡Œä¸åŒçš„å¤„ç†ï¼Œå¹¶ä¸”å‘ç”Ÿä¸åŒçš„çŠ¶æ€è½¬ç§»ã€‚è¿™ç§è§£å†³æ–¹æ¡ˆæŠŠæ‰€æœ‰çš„å®ç°ç»†èŠ‚éƒ½æ”¾åˆ°å®¢æˆ·ç±»ï¼Œè¿™æ ·åœ¨æ–°å¢çŠ¶æ€çš„æ—¶å€™å°±è¦å»ä¿®æ”¹å®¢æˆ·ç±»çš„ä»£ç ã€‚

![](https://github.com/00000H/notes/blob/master/pics/62ebbb63-8fd7-4488-a866-76a9dc911662.png)

**5. ä½¿ç”¨çŠ¶æ€æ¨¡å¼çš„è§£å†³æ–¹æ¡ˆ**

çŠ¶æ€çš„è½¬ç§»è¢«ç§»åˆ°çŠ¶æ€ç±»é‡Œé¢ï¼Œå®¢æˆ·ç±»çš„æ¯ä¸ªæ“ä½œåªéœ€è¦å§”æ‰˜ç»™çŠ¶æ€ç±»å³å¯ï¼Œè€Œä¸éœ€è¦çŸ¥é“å½“å‰æ˜¯ä»€ä¹ˆçŠ¶æ€ä»¥åŠçŠ¶æ€æ—¶å¦‚ä½•è¿›è¡Œè½¬ç§»çš„ã€‚


**6. ä»£ç å®ç°**

```java
public interface State {
    /**
     * æŠ•å…¥25 åˆ†é’±
     */
    void insertQuarter();

    /**
     * é€€å›25 åˆ†é’±
     */
    void ejectQuarter();

    /**
     * è½¬åŠ¨æ›²æŸ„
     */
    void turnCrank();

    /**
     * å‘æ”¾ç³–æœ
     */
    void dispense();
}
```
```java
public class HasQuarterState implements State{
    private GumballMachine gumballMachine;

    public HasQuarterState(GumballMachine gumballMachine){
        this.gumballMachine = gumballMachine;
    }

    @Override
    public void insertQuarter() {
        System.out.println("You can't insert another quarter");
    }

    @Override
    public void ejectQuarter() {
        System.out.println("Quarter returned");
        gumballMachine.setState(gumballMachine.getNoQuarterState());
    }

    @Override
    public void turnCrank() {
        System.out.println("You turned...");
        gumballMachine.setState(gumballMachine.getSoldState());
    }

    @Override
    public void dispense() {
        System.out.println("No gumball dispensed");
    }
}
```
```java
public class NoQuarterState implements State {
    GumballMachine gumballMachine;

    public NoQuarterState(GumballMachine gumballMachine) {
        this.gumballMachine = gumballMachine;
    }

    @Override
    public void insertQuarter() {
        System.out.println("You insert a quarter");
        gumballMachine.setState(gumballMachine.getHasQuarterState());
    }

    @Override
    public void ejectQuarter() {
        System.out.println("You haven't insert a quarter");
    }

    @Override
    public void turnCrank() {
        System.out.println("You turned, but there's no quarter");
    }

    @Override
    public void dispense() {
        System.out.println("You need to pay first");
    }
}
```
```java
public class SoldOutState implements State {

    GumballMachine gumballMachine;

    public SoldOutState(GumballMachine gumballMachine) {
        this.gumballMachine = gumballMachine;
    }

    @Override
    public void insertQuarter() {
        System.out.println("You can't insert a quarter, the machine is sold out");
    }

    @Override
    public void ejectQuarter() {
        System.out.println("You can't eject, you haven't inserted a quarter yet");
    }

    @Override
    public void turnCrank() {
        System.out.println("You turned, but there are no gumballs");
    }

    @Override
    public void dispense() {
        System.out.println("No gumball dispensed");
    }
}
```
```java
public class SoldState implements State {
    GumballMachine gumballMachine;

    public SoldState(GumballMachine gumballMachine) {
        this.gumballMachine = gumballMachine;
    }

    @Override
    public void insertQuarter() {
        System.out.println("Please wait, we're already giving you a gumball");
    }

    @Override
    public void ejectQuarter() {
        System.out.println("Sorry, you already turned the crank");
    }

    @Override
    public void turnCrank() {
        System.out.println("Turning twice doesn't get you another gumball!");
    }

    @Override
    public void dispense() {
        gumballMachine.releaseBall();
        if(gumballMachine.getCount()>0){
            gumballMachine.setState(gumballMachine.getNoQuarterState());
        } else{
            System.out.println("Oops, out of gumballs");
            gumballMachine.setState(gumballMachine.getSoldOutState());
        }
    }
}
```
```java
public class GumballMachine {
    private State soldOutState;
    private State noQuarterState;
    private State hasQuarterState;
    private State soldState;

    private State state;
    private int count = 0;

    public GumballMachine(int numberGumballs) {
        count = numberGumballs;
        soldOutState = new SoldOutState(this);
        noQuarterState = new NoQuarterState(this);
        hasQuarterState = new HasQuarterState(this);
        soldState = new SoldState(this);

        if (numberGumballs > 0) {
            state = noQuarterState;
        } else {
            state = soldOutState;
        }
    }

    public void insertQuarter() {
        state.insertQuarter();
    }

    public void ejectQuarter() {
        state.ejectQuarter();
    }

    public void turnCrank() {
        state.turnCrank();
        state.dispense();
    }

    public void setState(State state) {
        this.state = state;
    }

    public void releaseBall() {
        System.out.println("A gumball comes rolling out the slot...");
        if (count != 0) {
            count -= 1;
        }
    }

    public State getSoldOutState() {
        return soldOutState;
    }

    public State getNoQuarterState() {
        return noQuarterState;
    }

    public State getHasQuarterState() {
        return hasQuarterState;
    }

    public State getSoldState() {
        return soldState;
    }

    public int getCount() {
        return count;
    }
}
```
```java
public class GumballMachineTestDrive {
    public static void main(String[] args) {
        GumballMachine gumballMachine = new GumballMachine(5);

        gumballMachine.insertQuarter();
        gumballMachine.turnCrank();

        gumballMachine.insertQuarter();
        gumballMachine.ejectQuarter();
        gumballMachine.turnCrank();

        gumballMachine.insertQuarter();
        gumballMachine.turnCrank();
        gumballMachine.insertQuarter();
        gumballMachine.turnCrank();
        gumballMachine.ejectQuarter();

        gumballMachine.insertQuarter();
        gumballMachine.insertQuarter();
        gumballMachine.turnCrank();
        gumballMachine.insertQuarter();
        gumballMachine.turnCrank();
        gumballMachine.insertQuarter();
        gumballMachine.turnCrank();
    }
}
```
è¿è¡Œç»“æœ
```html
You insert a quarter
You turned...
A gumball comes rolling out the slot...
You insert a quarter
Quarter returned
You turned, but there's no quarter
You need to pay first
You insert a quarter
You turned...
A gumball comes rolling out the slot...
You insert a quarter
You turned...
A gumball comes rolling out the slot...
You haven't insert a quarter
You insert a quarter
You can't insert another quarter
You turned...
A gumball comes rolling out the slot...
You insert a quarter
You turned...
A gumball comes rolling out the slot...
Oops, out of gumballs
You can't insert a quarter, the machine is sold out
You turned, but there are no gumballs
No gumball dispensed
```

# ç¬¬ 11 ç«  ä»£ç†æ¨¡å¼ // TODO

# ç¬¬ 12 ç«  å¤åˆæ¨¡å¼

## 12.1 MVC

### 12.1.1 ä¼ ç»Ÿ MVC

è§†å›¾ä½¿ç”¨ç»„åˆæ¨¡å¼ï¼Œæ¨¡å‹ä½¿ç”¨äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œæ§åˆ¶å™¨ä½¿ç”¨äº†ç­–ç•¥æ¨¡å¼ã€‚

![](https://github.com/00000H/notes/blob/master/pics/4f67611d-492f-4958-9fa0-4948010e345f.jpg)

### 12.1.2 Web ä¸­çš„ MVC

æ¨¡å¼ä¸å†ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ã€‚

![](https://github.com/00000H/notes/blob/master/pics/1dd56e61-2970-4d27-97c2-6e81cee86978.jpg)

# ç¬¬ 13 ç«  ä¸è®¾è®¡æ¨¡å¼ç›¸å¤„

å®šä¹‰ï¼šåœ¨æŸ **æƒ…å¢ƒ** ä¸‹ï¼Œé’ˆå¯¹æŸ **é—®é¢˜** çš„æŸç§ **è§£å†³æ–¹æ¡ˆ**ã€‚

è¿‡åº¦ä½¿ç”¨è®¾è®¡æ¨¡å¼å¯èƒ½å¯¼è‡´ä»£ç è¢«è¿‡åº¦å·¥ç¨‹åŒ–ï¼Œåº”è¯¥æ€»æ˜¯ç”¨æœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆå®Œæˆå·¥ä½œï¼Œå¹¶åœ¨çœŸæ­£éœ€è¦æ¨¡å¼çš„åœ°æ–¹æ‰ä½¿ç”¨å®ƒã€‚

åæ¨¡å¼ï¼šä¸å¥½çš„è§£å†³æ–¹æ¡ˆæ¥è§£å†³ä¸€ä¸ªé—®é¢˜ã€‚ä¸»è¦ä½œç”¨æ˜¯ä¸ºäº†è­¦å‘Šä¸è¦ä½¿ç”¨è¿™äº›è§£å†³æ–¹æ¡ˆã€‚

æ¨¡å¼åˆ†ç±»ï¼š

![](https://github.com/00000H/notes/blob/master/pics/524a237c-ffd7-426f-99c2-929a6bf4c847.jpg)

# ç¬¬ 14 ç«  å‰©ä¸‹çš„æ¨¡å¼ // TODO
»£ç†æ¨¡å¼ // TODO

# ç¬¬ 12 ç«  å¤åˆæ¨¡å¼

## 12.1 MVC

### 12.1.1 ä¼ ç»Ÿ MVC

è§†å›¾ä½¿ç”¨ç»„åˆæ¨¡å¼ï¼Œæ¨¡å‹ä½¿ç”¨äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œæ§åˆ¶å™¨ä½¿ç”¨äº†ç­–ç•¥æ¨¡å¼ã€‚

![](https://github.com/00000H/notes/blob/master/pics/4f67611d-492f-4958-9fa0-494