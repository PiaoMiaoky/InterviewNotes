<!-- GFM-TOC -->
* [??????](#??????)
    * [1. ?????????](#1-?????????)
    * [2. Java ??????](#2-java-??????)
    * [3. ????????](#3-????????)
    * [4. Java ??](#4-java-??)
    * [5. ??????](#5-??????)
    * [6. ???????????](#6-???????????)
    * [7. ??????](#7-??????)
* [???????](#???????)
    * [1. ?ßÿ???????????????](#1-?ßÿ???????????????)
        * [1.1 ???®π???](#11-???®π???)
        * [1.2 ?????](#12-?????)
        * [1.3 ????????](#13-????????)
            * [1.3.1 ?????](#131-?????)
            * [1.3.2 ??????](#132-??????)
            * [1.3.3 ??????](#133-??????)
            * [1.3.4 ??????](#134-??????)
        * [1.3 ???????????](#13-???????????)
        * [1.4 finalize()](#14-finalize)
    * [2. ?????????](#2-?????????)
        * [2.1 ??? - ?????](#21-???---?????)
        * [2.2 ??????](#22-??????)
        * [2.3 ??? - ??????](#23-???---??????)
        * [2.4 ????????](#24-????????)
    * [3. ?????????](#3-?????????)
        * [3.1 Serial ?????](#31-serial-?????)
        * [3.2 ParNew ?????](#32-parnew-?????)
        * [3.3 Parallel Scavenge ?????](#33-parallel-scavenge-?????)
        * [3.4 Serial Old ?????](#34-serial-old-?????)
        * [3.5 Parallel Old ?????](#35-parallel-old-?????)
        * [3.6 CMS ?????](#36-cms-?????)
        * [3.7 G1 ?????](#37-g1-?????)
        * [3.8 ?????????????????](#38-?????????????????)
    * [4. ??????????????](#4-??????????????)
        * [4.1 ?????? Eden ????](#41-??????-eden-????)
        * [4.2 ????????????????](#42-????????????????)
        * [4.3 ??????????????????](#43-??????????????????)
        * [4.4 ????????????ßÿ?](#44-????????????ßÿ?)
        * [4.5 ????????](#45-????????)
    * [4.6 Full GC ?????????](#46-full-gc-?????????)
        * [4.6.1 ???? System.gc()](#461-????-systemgc)
        * [4.6.2 ??????????](#462-??????????)
        * [4.6.3 ???????????](#463-???????????)
        * [4.6.4 JDK 1.7 ?????????????????](#464-jdk-17-?????????????????)
        * [4.6.5 Concurrent Mode Failure](#465-concurrent-mode-failure)
* [????????](#????????)
    * [1 ???????????](#1-???????????)
    * [2. ?????????](#2-?????????)
    * [3. ????????](#3-????????)
        * [3.1 ????](#31-????)
        * [3.2 ???](#32-???)
        * [3.3 ???](#33-???)
        * [3.4 ????](#34-????)
        * [3.5 ?????](#35-?????)
    * [4. ???????](#4-???????)
        * [4.1 ???????????](#41-???????????)
        * [4.2 ???????????](#42-???????????)
        * [4.3 ?????????](#43-?????????)
* [JVM ????](#jvm-????)
    * [GC ???????](#gc-???????)
    * [GC ????????](#gc-????????)
<!-- GFM-TOC -->

# ??????

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/dc695f48-4189-4fc7-b950-ed25f6c80f82.jpg)

????????????????ß÷??????????????????

## 1. ?????????

?????????ß÷????????????????????????????ß÷??? Native ????????????

## 2. Java ??????

??? Java ????????ß÷????????????????õ•???????????????????????????????????????????????????????????????????????????????? Java ?????????????????????

????????????????????

1. ???????????????????????????? StackOverflowError ????
2. ????ßÿ????????????????????ó®????? OutOfMemoryError ????

## 3. ????????

?? Java ?????????????????????????????????????????????????

## 4. Java ??

???ßÿ???????????????????µµ

??????????????????????????????"GC ?? "???????????????????????°¬?????????Java ??????????????????????????????????????? Eden ???From Survivor ???To Survivor ???????

???????????ó®??????? -Xmx ?? -Xms ???????????????ß≥?????????????????? OutOfMemoryError ????

## 5. ??????

?????????????????????????????????????????????????????????????????

?? Java ??????????????????ó®??????????????????????????????? OutOfMemoryError ????

????????????????????????????????????????????ßÿ??????????????????HotSpot ?????????????????????????????????

## 6. ???????????

??????????????????????????

??????Class ????ß÷???????????????????????????????????????????????????????

???????????????®¥? String ??? intern() ?????????????????????

## 7. ??????

?? JDK 1.4 ????????? NIO ???????????????????Channel??????????Buffer???? I/O ?????????????? Native ?????????????????ó®??????????õ•?? Java ????? DirectByteBuffer ????????????????????ß”??????????????ßª????????????????????????????? Java ??? Native ????????????????

# ???????

?????????????????????????????????????????????ß÷????????????????????????????????????????????????????????????????????????

???????????????? Java ???????????ß≥?

## 1. ?ßÿ???????????????

### 1.1 ???®π???

???????????????®π????????????????????????????????? 1???????ßπ????????? 1??

???®π???? 0 ????????????

?????????????????????????????®π??????????? 0?????? GC ?????????????

```java
objA.instance = objB;
objB.instance = objA;
```

### 1.2 ?????

??? GC Roots ???????????????????????????????????????????????????????

GC Roots ???????????????

1. ????????????????
2. ???????????????????????
3. ???????ß÷????????????
4. ??????????????????

### 1.3 ????????

????????????®π??????ßÿ?????????????????????????????????ßÿ?????????????????ßÿ???????????????®¢??ß€??

#### 1.3.1 ?????

????????????????????????????????????????????

```java
Object obj = new Object();
```

#### 1.3.2 ??????


?????????????????????ß›????

```java
Object obj = new Object();
SoftReference<Object> sf = new SoftReference<Object>(obj);
obj = null;
sf.get();
```

sf ??? obj ??????????????? sf.get() ??????????????????????????????????????????????????? null??

????????????????????????????????????????????????????????????????????????????????????????????÷Œ???????????????????????????????????????ßª?????


#### 1.3.3 ??????

??????õ‘???????????????????????????????????????????????????????????????

```java
Object obj = new Object();
WeakReference<Object> wf = new WeakReference<Object>(obj);
obj = null;
wf.get();
wf.isEnQueued();
```

#### 1.3.4 ??????

?????????????????????????????????????????????????????????????Åq??????????????????????????????????????????????????®¥?????¶∑????????????????????????????????????????

```java
Object obj = new Object();
PhantomReference<Object> pf = new PhantomReference<Object>(obj);
obj=null;
pf.get();
pf.isEnQueued();
```

### 1.3 ???????????

???????????????????????????ßÿ???

?????????????ßÿ???????????

???ßÿ????????????????????????????????????????????????ßÿ???

1. ???????ß÷????????????????????? Java ???ß”??????????¶ ??????
2. ???????? ClassLoader ??????????
3. ???????? java.lang.Class ??????????¶ ¶≈??????????????????¶ ¶≈???????????????????

??????? -Xnoclassgc ???????????????????ßÿ???

???????°¬??????????CGLib ?? ByteCode ??????????? JSP ??? OSGo ???????????? ClassLoader ????????????????????ßÿ?????????????????????????

### 1.4 finalize()

???????????????????????????ß“????? finalize() ????????????ß·???????????°¬?????????????°¿????????????????

finalize() ???? C++ ???˚y??????????????????????????????? try-finally ????????????????????°¬??????ß’?????????????????????????????????????????®∞????®¢?

## 2. ?????????

### 2.1 ??? - ?????

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/a4248c4b-6c1d-4fb8-a557-86da92d3a294.jpg)

???????????????ß“???????????

????

1. ???????????ßπ???????
2. ????????????

???????????????????ß⁄????

### 2.2 ??????

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/e6b733ad-606d-4028-b3e8-83c3a73a3797.jpg)

????ú˝?????ß≥???????ÔÖ?????????????ÔÖ??????????????????????????????????????ó®????????®¥??????????????????

??????????????????????

??????????????????????????????????????????????????????ú˝?????ß≥???????ÔÖ???????????? Eden ?????????ß≥?? Survior ????????? Eden ??????????? Survivor???????????? Eden ?? Survivor ?ß›???????????????????????? Survivor ????????????? Eden ?? Survivor??HotSpot ??????? Eden ?? Survivor ???ß≥???????? 8:1?????????????????? 90 %???????¶À????ßÿ??? 10% ????????????? Survivor ?????????????????????????????ßŸ????????????????????????

### 2.3 ??? - ??????

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/902b83ab-8054-4bd2-898f-9a4a0fe52830.jpg)

?????ß’??????????????????????????????????????µµ

### 2.4 ????????

????????????????°¬?????????????????????????????????????????????????ú˝??????ÔÖ????????????????????

??? Java ???????????????????

1. ????????????????
2. ???????????? - ???? ???? ??? - ???? ????

## 3. ?????????

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/c625baa0-dde6-449e-93df-c3a67f2f430f.jpg)

?????? HotSpot ??????ß÷? 7 ?????????????????????????????????????®¢?

### 3.1 Serial ?????

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/22fda4ae-4dd5-489d-ab10-9ebfdad22ae0.jpg)

??????????????????????¶∆????????????????????????????????????????????????????????????????????????????????????????????????

???????????ßπ????????? CPU ??????????????????????????????????????????????ßπ???

?? Client ??®Æ????ßµ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????

### 3.2 ParNew ?????

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/81538cd5-1bcf-4e31-86e5-e198df1e013b.jpg)

???? Serial ???????????∑⁄??

?? Server ??????????????????????????????????????????????????? Serial ???????????????? CMS ?????????????

???????????????? CPU ???????????????? -XX:ParallelGCThreads ?????????????????

### 3.3 Parallel Scavenge ?????

????ß÷????????????

?????????????????????????????????????????????????????????????????????????????????????????????????????????????????? CPU ??????????????????????????????

??????????????????????????????????????????????????????Óï????????????????ßπ??????? CPU ?????????????????????????????????????????????????????

?????????????????????????????????????????????????????? -XX:MaxGCPauseMillis ??????????????????????ß≥?? -XX:GCTimeRatio ???????????? 0 ??ß≥?? 100 ???????????????????????????????????????????????????????????????ß≥????????????????????????????????

????????????? -XX:+UseAdaptiveSizePolicy?????????????????????????????????????????????ß≥??-Xmn????Eden ?? Survivor ?????????-XX:SurvivorRatio?????????????????????-XX:PretenureSizeThreshold???????????????????????????????????????????????????????????ßª???????????????????????????????????????????? GC ??????????????GC Ergonomics??????????????????????? ParNew ?????????????????

### 3.4 Serial Old ?????

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/08f32fd3-f736-4a67-81ca-295b2a7972f2.jpg)

Serial Old ?? Serial ?????????????∑⁄?????? Client ????????????®¢???????? Server ??????????????????

1. ?? JDK 1.5 ??????∑⁄??Parallel Old ????????????? Parallel Scavenge ???????????®¢?
2. ??? CMS ????????????????????????? Concurrent Mode Failure ???®¢?

### 3.5 Parallel Old ?????

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/278fe431-af88-4a95-a895-9c3b80117de3.jpg)

?? Parallel Scavenge ?????????????∑⁄??

?????????????? CPU ??????ß÷?????????????????? Parallel Scavenge ?? Parallel Old ???????

### 3.6 CMS ?????

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/62e77997-6957-4b68-8d12-bfd609bb2c68.jpg)

CMS??Concurrent Mark Sweep?????? Mark Sweep ?????????????? ??? - ??? ???????

??????????????????

???????????????

1. ??????????????????? GC Roots ???????????????????????????
2. ???????????? GC Roots Tracing ??????????????????????ß‹???????????????
3. ???°¿?????????????????????????????????????????°¿?????????????????????????????????
4. ??????????????????

???????????ß‹????????????????????????ßµ??????????????????????????????????????????

???????????

1. ?? CPU ??????ß≥?CMS ??????????????????? (CPU ???? + 3) / 4???? CPU ???? 4 ?????CMS ??????????????????®≤????????? CPU ???????????????????????????????????????????????????????????????????? 50%?????????????????????????????????????????????????????? CPU ?????????

2. ??????????????????????????????????????????????????????????????????????????????????????????????????????????CMS ????????????ß’????????????????????? GC ?????????????????????????????????????????????????????????????????????????ßµ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????®¢???????? -XX:CMSInitiatingOccupancyFraction ???????????????????????????????JDK 1.5 ???????????? 68?????????????????? 68% ?????????????????????????????????????????????????????ó®????????? Concurrent Mode Failure?????????????????????????????? Serial Old ??????????????????????????????

3. ??? - ??????????????????????????????????˙ë?????????????????????????????????????????????????????®∞??????????? Full GC??

### 3.7 G1 ?????

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/f99ee771-c56f-47fb-9148-c0036695b5fe.jpg)

G1??Garbage-First??????????????????????????????????????????????????????????????????HotSpot ?????????????????????????????¶ƒ???????ùI?? JDK 1.5 ?ßŸ????? CMS ???????

??????????

- ??????????????????? CPU ???????????????????? CPU ????????????
- ??????????????????????????????????????????????????????????????? GC ?????????????®∞?????????????????????????????????????? GC ???????????????????ßπ????
- ????????????????????????? - ??????????????????????????? Region ???????????????????????????????¶∆????????????????????????
- ??????????????????? CMS ?????????????????????? G1 ?? CMS ??????????? G1 ???????????????????????????????????????????????????????????? M ???????????????????? GC ???????®Æ??? N ??????????????? Java??RTSJ??????????????????????

?? G1 ???????????????????????¶∂???????????????????????????? G1 ????????????Java ?????’”??????????????ß‹??????????? Java ???????????ß≥???????????Region?????????????????????????????????????????????????????????????????????????? Region???????????????????

??????????????????????????????????????ßﬁ????????????? Java ???ßﬂ??????????????????????????? Region ??????????????????ß≥???????????????ß≥??????????????????????????????????????ß“???¶»??????????????????????????? Region????????? Garbage-First ??????????????????? Region ???????????????????????????????????????????????????????????????????ßπ???

Region ????????????????????????????? Region ?ßµ??????????? Java ???????????????®¥?????????????????????????????????????????? Java ???????????????????? GC ßπ???????????????????????????????? Region ?????????????????? Remembered Set????????????????? Reference ????????????ß’??????????????? Write Barrier ????ßÿ?ß’????????? Reference ????????????????? Region ??ßµ???????????? CardTable ???????????????????????????????? Region ?? Remembered Set ??ß≥?????????????????? GC ??????????¶∂?ßﬁ??? Remembered Set ????????????????????????????

???????????? Remembered Set ???????G1 ??????????????????????????????—s

1. ??????
2. ???????
3. ??????????????????????????????????????????????°¿??????????????????????????????????????Å£????????? Remembered Set Logs ???ó®????????????? Remembered Set Logs ?????????? Remembered Set ?ß≥?????????????????????????ß≥?
4. ??????????????? Region ?ß÷???????????????????????????????? GC ????????????????????????????????????????????????????ßµ?????????????????? Region??????????????????????????????????????????ßπ???

### 3.8 ?????????????????

| ????? | ???ß≥????? or ???? | ?????? / ????? | ?? | ??? | ???®Æ??? |
| --- | --- | --- | --- | --- | --- |
| **Serial** | ???? | ?????? | ?????? | ?????????? | ?? CPU ??????? Client ?? |
| **Serial Old** | ???? | ????? | ??? - ???? | ?????????? | ?? CPU ??????? Client ????CMS ?????? |
| **ParNew** | ???? | ?????? | ?????? | ?????????? | ?? CPU ??????? Server ?????? CMS ??? |
| **Parallel Scavenge** | ???? | ?????? | ?????? | ?????????? | ????????????????????????? |
| **Parallel Old** | ???? | ????? | ??? - ???? | ?????????? | ????????????????????????? |
| **CMS** | ???? | ????? | ??? - ??? | ?????????? | ?????????????? B/S ?????????? Java ??? |
| **G1** | ???? | both | ??? - ???? + ?????? | ?????????? | ?????????????????ùI CMS |

## 4. ??????????????

### 4.1 ?????? Eden ????

??????????????????????? Eden ???????? Eden ?????????????? Minor GC??

### 4.2 ????????????????

?? -XX:PretenureSizeThreshold ????????????????????????????????????? Eden ???? Survivor ???????????ø ???
### 4.3 ??????????????????

JVM ?????????????????????? Minor GC ????????? Survivor ????????????? Survivor ????????? 1?????????? Minor GC ??????????????? 1???????????????????????????????? 15 ????? -XX:MaxTenuringThreshold ???????


### 4.4 ????????????ßÿ?

?? Survivor ????????????ßÿ????ß≥?????? Survivor ???????????????????????????????????????????

### 4.5 ????????

????? Minor GC ????JVM ?????????????????????????????????????ßÿ?????????????? Minor GC ???????????????????????????????????????????????¶Õ????????????????????ß≥???????????? Minor GC??ß≥???????? Full GC??

## 4.6 Full GC ?????????

???? Minor GC?????????????????? Eden ???????????????????? Minor GC???? Full GC ?????????????????????

### 4.6.1 ???? System.gc()

??????????????? JVM ???? Full GC??????????????????????????????????? Full GC????????? Full GC ????????????????ßº???????????????????????????????????????????????????????????ó®????? -XX:+ DisableExplicitGC ????? RMI ???? System.gc()??

### 4.6.2 ??????????

??????????????????????????????????????????????????????????????????????? Full GC ??????????????????????? Java.lang.OutOfMemoryError: Java heap space ????????????????????? Full GC??????????????????????? Minor GC ??¶¡????????????????????????????π¿??????????????????Óï

### 4.6.3 ???????????

?????????? Minor GC ???????????????????????????????? HandlePromotionFailure ????????????? Full GC??

### 4.6.4 JDK 1.7 ?????????????????

?? JDK 1.7 ???????HotSpot ??????ß÷??????????????????????????ß’?????ßª class ??????????????????????????????????????????????????????????????Permanet Generation ????????????¶ƒ????????? CMS GC ????????????? Full GC????????? Full GC ?????????????? JVM ?????????????????java.lang.OutOfMemoryError: PermGen space ????? PermGen ?????? Full GC ????????????????? PermGen ????????? CMS GC??

?? JDK 1.8 ?????????ùI?????????????????????????????????ó®??????????? Full GC ????????????

### 4.6.5 Concurrent Mode Failure

??? CMS GC ??????????ßÿ????????????????????????????????????????? CMS GC ??????????????????????????????? Full GC??????? Concurrent Mode Failure ????????? Full GC??

# ????????

????????????????????

## 1 ???????????

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/32b8374a-e822-4720-af0b-c0f485095ea2.jpg)

???????? 7 ????¶≤?

- **?????Loading??**
- **?????Verification??**
- **?????Preparation??**
- **??????Resolution??**
- **???????Initialization??**
- ????Using??
- ßÿ???Unloading??

???ßﬂ??????????ßª???????????????????????????????????? Java ???????

## 2. ?????????

??????úZ?ß”????????????????ßﬁ????????úZ???’«?????????????????????????????ß‘??????( ???????????????????????? )

1. ???? new??getstatic??putstatic??invokestatic ????????????????????????ßﬂ??ß€?????????????????????????????????????? 4 ??????????????? new ????????????????????????????????????¶≤??? final ???¶±???????????????????????????¶√????????????????????????????????

2. ??? java.lang.reflect ?????????????ßŸ?????????????????ßﬂ??ß‘????????????????????????

3. ????????????????????????ÕË????ßﬂ??ß€???????????????????ÕË?????????

4. ?????????????????????????????ß÷????????? main() ?????????????????????????????????

5. ????? jdk1.7 ???????????????????? java.lang.invoke.MethodHandle ?????????????? REF_getStatic, REF_putStatic, REF_invokeStatic ???????????????????????????????????ßﬂ??ß€??????????????????????????

???? 5 ??????ß÷????????????????????????®¢??????????????????????????????????????????????®¢??????????????????????

1\. ???????????????????¶≤?????????????????

```java
System.out.println(SubClass.value); // value ????? SuperClass ?ßÿ???
```

2\. ??????˙E????????????????????????????®¥?????????????ß‘???????????????????????????????????????? Object ?????????ß—????????????????????

```java
SuperClass[] sca = new SuperClass[10];
```

3\. ??????????¶À????????????????ßµ??????????????????????çi?????????????????çi?????????????

```java
System.out.println(ConstClass.HELLOWORLD);
```

## 3. ????????

???????????????????????????????? 5 ????¶±?

### 3.1 ????

?????????????????¶≤???????????

?????????????????????

1. ????????????????????????????????????????
2. ????????????????????õ•????????????????????õ•????
3. ???????????????????????? Class ??????????????????????????????????

???ßÿ??????????????????°§???ß›????

- ?? ZIP ???????????????????????? JAR??EAR??WAR ??????????
- ???????ß›?????????????????????? Applet??
- ???????????????????????????????????????????? java.lang.reflect.Proxy ?ßµ????????? ProxyGenerator.generateProxyClass ????????????????????
- ??????????????????????? JSP ???????? JSP ??????????? Class ??
- ????????????????????????????????ßª?ßﬁ???????????? SAP Netweaver?????????????????????????????????????????????
...

### 3.2 ???

??? Class ???????????ß—??????????????????????????????¶≤????????????????

????????? 4 ????¶≤?

1. ?????????
2. ???????????????????????????????????????
3. ??????????????????????????????????????????????????????????????????????????ßµ???????
4. ???????????

### 3.3 ???

???????? static ???¶≈????????????????????????õg???®Æ????????????????????µµ

????????????????¶«?????ó®???????????????????????????????? Java ???ß≥?

???????? 0 ????????????????? value ???????? 0 ?????? 123??

```java
public static int value = 123;
```

??????????????????????????????ß‘??????????????? 0??

```java
public static final int value = 123;
```

### 3.4 ????

?????????????????ùI?????????????

### 3.5 ?????

???????¶Ã??????????????? &lt;clinit>() ??????????

???????¶≤?????????????????????????????????????¶≤?????????????????????????????????????????????????

&lt;clinit>() ???????????????

- ???????????????????????????????????????????˜œstatic{} ?ÔÇ?ß÷???????????????????????????????????????ß‘??????????????????????????????????????????????????????????????????????????????????????????????????

```java
public class Test {
    static {
        i = 0;                // ????????????????????????
        System.out.print(i);  // ????????????????????????®¢?
    }
    static int i = 1;
}
```

- ?????????????????????????? &lt;init>()??????????????????????????????????????????????????? &lt;clinit>() ????????????????? &lt;clinit>() ?????????ßﬂ??????????????ß÷??????? &lt;clinit>() ??????????? java.lang.Object??

- ???????? &lt;clinit>() ????????ßµ??????¶∆??????ßÿ???????????????????????????????????????????

```java
static class Parent {
        public static int A = 1;
        static {
            A = 2;
        }
}

static class Sub extends Parent {
        public static int B = A;
}

public static void main(String[] args) {
        System.out.println(Sub.B);  // ????????????ß÷???????? A??????? 2
}
```

- &lt;clinit>() ??????????????????????????????ß”???????????ÔÖ???ßÿ???????????????????????????????????? &lt;clinit>() ??????

- ????ß”?????????????ÔÖ??????????????????????????????????????????????? &lt;clinit>() ???????????????????????ßﬂ??? &lt;clinit>() ?????????????ß⁄????? &lt;clinit>() ????????ß÷???????ßÿ????????????????????????????????????????????????????????ßﬂ??? &lt;clinit>() ??????

- ?????????????? &lt;clinit>() ??????????????°¿????????????????????????????????????????????????????????? &lt;clinit>() ???????????????????????????????????? &lt;clinit>() ??????????????????? &lt;clinit>() ???????ß‹??????????????????????????????????????ß’????????????¶±?

## 4. ???????

????????????????????ß÷????????????????????????????????????????? ( ??????? )???????????? Java ???????????????????®Æ???????????????????????????????????????????????????????????

### 4.1 ???????????

???????????????????????????????????????????????????? Java ??????ß÷?¶∑??????????????????????????????????????????????????????????????????????????????????????? Class ????? equals() ??????isAssignableFrom() ??????isInstance() ????????????????????? instanceof() ????????????????????ßÿ?????????????????????????????????????????????????????»…??????????????????????? Class ???????????????????????????????????????????????????????????????

### 4.2 ???????????

?? Java ?????????????????????????????????????????

??????????????????Bootstrap ClassLoader???????????????? C++ ??????????????????????????????????????????????????ßª???? Java ???????????????????????????????????? java.lang.ClassLoader??

?? Java ??????????????????????????????????ßª??

- ?????????????Bootstrap ClassLoader?? ????????????????? <JAVA_HOME>\lib ???ß÷??????? -Xbootclasspath ???????????°§???ß÷?????????????????????????????????? rt.jar???????????????????? lib ??????????????????????????????ß≥? ???????????????? Java ??????????????????ß’????????????????????????????????????????????????????? null ???ùr?®¿?

- ????????????Extension ClassLoader?? ?????????????? ExtClassLoader??sun.misc.Launcher$ExtClassLoader????????????? <Java_Home>/lib/ext ????? java.ext.dir ???????????°§???ß÷????????????????ßµ????????????????????????????

- ??®Æ????????????Application ClassLoader?? ?????????????? AppClassLoader??sun.misc.Launcher$AppClassLoader??????????????????????? ClassLoader ?ß÷? getSystemClassLoader() ?????????????????????????????????????????????°§????ClassPath??????????????????????????????????????????????®Æ?????????????????????????????????????????????????????????????

### 4.3 ?????????

??®Æ?????????????????????????ßﬁ?????????ß“?????????????????????????????????????????????????¶…??????????????????????????Parents Delegation Model??????????????????????????????????????????????????????????????????????????????????????????????Composition??????????????????????ßµ?Inheritance??????????

![](https://github.com/CyC2018/InterviewNotes/blob/master/pics/2cdc3ce2-fa82-4c22-baaa-000c07d10473.jpg)

**????????**

??????????????????????????????????????????????????????????????????????????????????¶≈?????????????????¶≈?ÔÖ??????ß÷?????????????????????????????????????ßµ???ß÷??????????????????????????????????????¶∂?????????????????????????????????????

**???**

??????????????????????????????????? Java ??????????????????????????????????????¶…?????????? java.lang.Object????????? rt.jar ?ßµ??????????????????????????????????????????????????????????????ßﬁ??????? Object ???????????????????????ßÿ????????????????????????????????????????????ßﬁ???????????????ß’??????????java.lang.Object ?????????????? ClassPath ?ßµ??????ßﬂ????????????? Object ????????????????????????????ß’????? rt.jar ????????????????? Java ??????????????????????????????????????ß≥?

**???**

```java
protected synchronized Class<?> loadClass(String name, boolean resolve) throws ClassNotFoundException{
    //check the class has been loaded or not
    Class c = findLoadedClass(name);
    if(c == null) {
        try{
            if(parent != null) {
                c = parent.loadClass(name, false);
            } else{
                c = findBootstrapClassOrNull(name);
            }
        } catch(ClassNotFoundException e) {
            //if throws the exception , the father can not complete the load
        }
        if(c == null) {
            c = findClass(name);
        }
    }
    if(resolve) {
        resolveClass(c);
    }
    return c;
}
```

# JVM ????

## GC ???????

| ???? | ???? |
| --- | --- |
| -Xms | ???????????ß≥ |
| -Xmx | ????????? |
| -Xmn | ????????ß≥ |
| -XX:PermSize | ????????????ß≥ |
| -XX:MaxPermSize | ???????????? |

## GC ????????

| ???? | ???? |
| --- | --- |
| -XX:+UseSerialGC | ?????????????? |
| -XX:+UseParallelGC | ?????????????? |
| -XX:+UseConcMarkSweepGC | ???????????????????? |
| -XX:ParallelCMSThreads= | ???????????????????? = ???????????? |
| -XX:+UseG1GC | G1 ?????????? |

```java
java -Xmx12m -Xms3m -Xmn1m -XX:PermSize=20m -XX:MaxPermSize=20m -XX:+UseSerialGC -jar java-application.jar
```
